{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://blankbook/../../../OneDrive/Development/HTML/BlankBook/public/js/state.js","webpack://blankbook/../../../OneDrive/Development/HTML/BlankBook/public/js/utils.js","webpack://blankbook/webpack/bootstrap","webpack://blankbook/webpack/runtime/define property getters","webpack://blankbook/webpack/runtime/hasOwnProperty shorthand","webpack://blankbook/webpack/runtime/make namespace object","webpack://blankbook/../../../OneDrive/Development/HTML/BlankBook/public/js/main.js"],"sourcesContent":["// state.js\r\n\r\nconst state = {\r\n  variables: [],\r\n  variableCounts: {},\r\n  insertionCounter: 0,\r\n  storyText: '',\r\n  customPlaceholders: [],\r\n  fillValues: {},\r\n  pronounGroups: {},\r\n  pronounGroupCount: 0,\r\n  lastRange: null,\r\n  usageTracker: {},\r\n  placeholderInsertionInProgress: false,\r\n  storyHasUnsavedChanges: false,\r\n  fillOrder: 'alphabetical',\r\n  currentStoryId: null,\r\n  currentPlaceholderSearch: '',\r\n  currentModalPlaceholderSearch: '',\r\n  currentEditingVariable: null,\r\n  currentPlaceholderElement: null,\r\n  isEditingPlaceholder: false,\r\n};\r\n\r\nexport default state;\r\n\r\nexport const pronounMapping = {\r\n  \"He/Him\": { subject: \"he\", object: \"him\", possAdj: \"his\", possPron: \"his\", reflexive: \"himself\" },\r\n  \"She/Her\": { subject: \"she\", object: \"her\", possAdj: \"her\", possPron: \"hers\", reflexive: \"herself\" },\r\n  \"They/Them\": { subject: \"they\", object: \"them\", possAdj: \"their\", possPron: \"theirs\", reflexive: \"themselves\" }\r\n};\r\n\r\nexport function resetState() {\r\n  state.variables = [];\r\n  state.variableCounts = {};\r\n  state.insertionCounter = 0;\r\n  state.storyText = '';\r\n  state.customPlaceholders = [];\r\n  state.fillValues = {};\r\n  state.pronounGroups = {};\r\n  state.pronounGroupCount = 0;\r\n  state.lastRange = null;\r\n  state.usageTracker = {};\r\n  state.placeholderInsertionInProgress = false;\r\n  state.storyHasUnsavedChanges = false;\r\n}\r\n","// public/js/utils.js\r\nexport const Utils = {\r\n    debounce: (func, delay) => {\r\n      let timeout;\r\n      return function(...args) {\r\n        const context = this;\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(() => func.apply(context, args), delay);\r\n      };\r\n    },\r\n    toTitleCase: (str) =>\r\n      str.replace(/\\w\\S*/g, (txt) => txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase()),\r\n    capitalize: (str) => str.charAt(0).toUpperCase() + str.slice(1).toLowerCase(),\r\n    pascalCase: (str) => str.toLowerCase().split(/\\s+/).map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()).join(''),\r\n    naturalDisplay: (str) => str.replace(/([a-z])([A-Z])/g, '$1 $2'),\r\n    sanitizeString: (str) => str.replace(/[^a-zA-Z0-9_]/g, '')\r\n  };\r\n  \r\n  export const decodeHTMLEntities = (text) => {\r\n    const textarea = document.createElement(\"textarea\");\r\n    textarea.innerHTML = text;\r\n    return textarea.value;\r\n  };","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// public/js/main.js\r\n\r\nimport State from './state.js';\r\nimport { Utils, decodeHTMLEntities } from './utils.js';\r\n\r\n\r\n(function () {\r\n    \"use strict\";\r\n\r\n    window.Utils = Utils;\r\n    window.decodeHTMLEntities = decodeHTMLEntities;\r\n\r\n    // ====================================================\r\n    // 1. UTILITY FUNCTIONS\r\n    // ====================================================\r\n\r\n    //   const Utils = {\r\n    //     debounce: (func, delay) => {\r\n    //       let timeout;\r\n    //       return function(...args) {\r\n    //         const context = this;\r\n    //         clearTimeout(timeout);\r\n    //         timeout = setTimeout(() => func.apply(context, args), delay);\r\n    //       };\r\n    //     },\r\n    //     toTitleCase: (str) =>\r\n    //       str.replace(/\\w\\S*/g, (txt) => txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase()),\r\n    //     capitalize: (str) => str.charAt(0).toUpperCase() + str.slice(1).toLowerCase(),\r\n    //     pascalCase: (str) => str.toLowerCase().split(/\\s+/).map(Utils.capitalize).join(''),\r\n    //     naturalDisplay: (str) => str.replace(/([a-z])([A-Z])/g, '$1 $2'),\r\n    //     sanitizeString: (str) => str.replace(/[^a-zA-Z0-9_]/g, '')\r\n    //   };\r\n\r\n    // ====================================================\r\n    // 2. GLOBAL STATE State.VARIABLES\r\n    // ====================================================\r\n\r\n    const pronounMapping = {\r\n        \"He/Him\": { subject: \"he\", object: \"him\", possAdj: \"his\", possPron: \"his\", reflexive: \"himself\" },\r\n        \"She/Her\": { subject: \"she\", object: \"her\", possAdj: \"her\", possPron: \"hers\", reflexive: \"herself\" },\r\n        \"They/Them\": { subject: \"they\", object: \"them\", possAdj: \"their\", possPron: \"theirs\", reflexive: \"themselves\" }\r\n    };\r\n\r\n    // NEW: Global to store the current story's database ID when loaded.\r\n    let currentStoryId = null;\r\n\r\n    // NEW: Global State.variables to persist the current search values\r\n    let currentPlaceholderSearch = '';\r\n    let currentModalPlaceholderSearch = '';\r\n\r\n    // ====================================================\r\n    // 2a. Capture Selection Changes\r\n    // ====================================================\r\n    document.addEventListener('selectionchange', () => {\r\n        const editor = document.getElementById(\"storyText\");\r\n        const sel = window.getSelection();\r\n        if (sel.rangeCount > 0 && editor.contains(sel.anchorNode)) {\r\n            State.lastRange = sel.getRangeAt(0);\r\n        }\r\n    });\r\n\r\n    // ====================================================\r\n    // 3. STORAGE HELPER FUNCTIONS (Server-side)\r\n    // ====================================================\r\n    const Storage = {\r\n        handleAjaxError: (xhr, statusText, errorThrown, customErrorMessage) => {\r\n            let errorMessage = customErrorMessage || 'Failed to perform action';\r\n            if (xhr.status) {\r\n                errorMessage += `. Server responded with status: ${xhr.status} ${xhr.statusText}`;\r\n            } else if (statusText) {\r\n                errorMessage += `. Status text: ${statusText}`;\r\n            } else if (errorThrown) {\r\n                errorMessage += `. Error: ${errorThrown}`;\r\n            }\r\n            Swal.fire('Error', errorMessage, 'error');\r\n            console.error(\"AJAX Error:\", errorMessage, xhr);\r\n        },\r\n        addCurrentStoryToSavedStories: () => {\r\n            const story = {\r\n                storyTitle: $('#storyTitle').val(),\r\n                storyAuthor: $('#storyAuthor').val(),\r\n                storyText: $('#storyText').html(),\r\n                variables: State.variables,\r\n                pronounGroups: State.pronounGroups,\r\n                variableCounts: State.variableCounts,\r\n                pronounGroupCount: State.pronounGroupCount,\r\n                customPlaceholders: State.customPlaceholders,\r\n                tags: $('#storyTags').val() ? $('#storyTags').val().split(',').map(s => s.trim()) : [],\r\n                savedAt: new Date().toISOString(),\r\n                password: data.password || null\r\n            };\r\n            $.ajax({\r\n                url: '/api/savestory',\r\n                method: 'POST',\r\n                contentType: 'application/json',\r\n                data: JSON.stringify(story),\r\n                success: () => {\r\n                    Swal.fire({\r\n                        toast: true,\r\n                        position: 'top-end',\r\n                        icon: 'success',\r\n                        title: 'Story saved to site!',\r\n                        showConfirmButton: false,\r\n                        timer: 1500\r\n                    });\r\n                },\r\n                error: (xhr, statusText, errorThrown) => {\r\n                    if (xhr.status === 409) {\r\n                        Swal.fire({\r\n                            title: 'Story exists',\r\n                            text: 'A story with this title already exists. Overwrite?',\r\n                            icon: 'warning',\r\n                            showCancelButton: true,\r\n                            confirmButtonText: 'Yes, overwrite',\r\n                            cancelButtonText: 'No'\r\n                        }).then((result) => {\r\n                            if (result.isConfirmed) {\r\n                                // Create a new story object with the overwrite flag\r\n                                let storyWithOverwrite = {\r\n                                    storyTitle: data.title,\r\n                                    storyAuthor: data.author,\r\n                                    storyText: $('#storyText').html(),\r\n                                    variables: State.variables,\r\n                                    pronounGroups: State.pronounGroups,\r\n                                    variableCounts: State.variableCounts,   \r\n                                    pronounGroupCount: State.pronounGroupCount,\r\n                                    customPlaceholders: State.customPlaceholders,\r\n                                    tags: data.tags ? data.tags.split(',').map(s => s.trim()) : [],\r\n                                    savedAt: new Date().toISOString(),\r\n                                    password: data.password || null,\r\n                                    overwrite: true  // Add the overwrite flag\r\n                                };\r\n\r\n                                $.ajax({\r\n                                    url: '/api/savestory',\r\n                                    method: 'POST',\r\n                                    contentType: 'application/json',\r\n                                    data: JSON.stringify(storyWithOverwrite),\r\n                                    success: () => {\r\n                                        Swal.fire({\r\n                                            toast: true,\r\n                                            position: 'top-end',\r\n                                            icon: 'success',\r\n                                            title: 'Story overwritten!',\r\n                                            showConfirmButton: false,\r\n                                            timer: 1500\r\n                                        });\r\n                                    },\r\n                                    error: (xhrOverwrite, statusTextOverwrite, errorThrownOverwrite) => {\r\n                                        Storage.handleAjaxError(xhrOverwrite, statusTextOverwrite, errorThrownOverwrite, 'Failed to overwrite story');\r\n                                    }\r\n                                });\r\n                            }\r\n                        });\r\n                    } else {\r\n                        Storage.handleAjaxError(xhr, statusText, errorThrown, 'Failed to save story');\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        addCompletedStoryToSavedStories: () => {\r\n            const story = {\r\n                storyTitle: $('#displayTitle').text(),\r\n                storyAuthor: $('#displayAuthor').text(),\r\n                storyText: State.storyText,\r\n                variables: State.variables,\r\n                pronounGroups: State.pronounGroups,\r\n                variableCounts: State.variableCounts,\r\n                pronounGroupCount: State.pronounGroupCount,\r\n                customPlaceholders: State.customPlaceholders,\r\n                tags: $('#displayTags').text() ? $('#displayTags').text().split(',').map(s => s.trim()) : [],\r\n                savedAt: new Date().toISOString(),\r\n                password: data.password || null\r\n            };\r\n            $.ajax({\r\n                url: '/api/savestory',\r\n                method: 'POST',\r\n                contentType: 'application/json',\r\n                data: JSON.stringify(story),\r\n                success: () => {\r\n                    Swal.fire({\r\n                        toast: true,\r\n                        position: 'top-end',\r\n                        icon: 'success',\r\n                        title: 'Completed story saved to site!',\r\n                        showConfirmButton: false,\r\n                        timer: 1500\r\n                    });\r\n                },\r\n                error: (xhr, statusText, errorThrown) => {\r\n                    if (xhr.status === 409) {\r\n                        Swal.fire({\r\n                            title: 'Story exists',\r\n                            text: 'A story with this title already exists. Overwrite?',\r\n                            icon: 'warning',\r\n                            showCancelButton: true,\r\n                            confirmButtonText: 'Yes, overwrite',\r\n                            cancelButtonText: 'No'\r\n                        }).then((result) => {\r\n                            if (result.isConfirmed) {\r\n                                story.overwrite = true;\r\n                                $.ajax({\r\n                                    url: '/api/savestory',\r\n                                    method: 'POST',\r\n                                    contentType: 'application/json',\r\n                                    data: JSON.stringify(story),\r\n                                    success: () => {\r\n                                        Swal.fire({\r\n                                            toast: true,\r\n                                            position: 'top-end',\r\n                                            icon: 'success',\r\n                                            title: 'Completed story overwritten!',\r\n                                            showConfirmButton: false,\r\n                                            timer: 1500\r\n                                        });\r\n                                    },\r\n                                    error: (xhrOverwrite, statusTextOverwrite, errorThrownOverwrite) => {\r\n                                        Storage.handleAjaxError(xhrOverwrite, statusTextOverwrite, errorThrownOverwrite, 'Failed to overwrite completed story');\r\n                                    }\r\n                                });\r\n                            }\r\n                        });\r\n                    } else {\r\n                        Storage.handleAjaxError(xhr, statusText, errorThrown, 'Failed to save completed story');\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        loadSavedStoriesList: () => {\r\n            const tag = $('#filterTag').val();\r\n            const sort = $('#sortOption').val();\r\n            $.ajax({\r\n                url: `/api/getstories?tag=${encodeURIComponent(tag || '')}&sort=${encodeURIComponent(sort || 'date_desc')}`,\r\n                method: 'GET',\r\n                success: (stories) => {\r\n                    // Store the fetched stories globally for later reference\r\n                    window.savedStories = stories;\r\n                    const $listContainer = $('#savedStoriesList').empty();\r\n                    if (!stories.length) {\r\n                        $listContainer.append('<p>No stories saved yet.</p>');\r\n                        return;\r\n                    }\r\n                    stories.forEach((story, index) => {\r\n                        const dateObj = new Date(story.savedAt);\r\n                        const dateStr = dateObj.toLocaleDateString() + \" \" + dateObj.toLocaleTimeString();\r\n                        const tags = story.tags && story.tags.length ? story.tags.join(', ') : 'No tags';\r\n                        const ratingDisplay = story.ratingCount ? `Rating: ${story.rating.toFixed(1)} (${story.ratingCount} votes)` : 'No ratings';\r\n                        const lockIndicator = story.locked ? `<i class=\"fas fa-lock\" title=\"Password Protected\"></i> ` : '';\r\n                        const item = $(`\r\n              <div class=\"list-group-item p-2\">\r\n                <div class=\"d-flex justify-content-between align-items-center\">\r\n                  <div>\r\n                    <strong>${lockIndicator}${story.storyTitle || 'Untitled'}</strong><br>\r\n                    <small>${story.storyAuthor || 'Unknown'} | ${dateStr}</small><br>\r\n                    <small>${tags} | ${ratingDisplay}</small>\r\n                  </div>\r\n                  <div>\r\n                    <button class=\"btn btn-sm btn-secondary editSavedStoryBtn\" data-index=\"${index}\" aria-label=\"Edit Story\">\r\n                      <i class=\"fas fa-edit\"></i>\r\n                    </button>\r\n                    <button class=\"btn btn-sm btn-success loadSavedStoryBtn\" data-index=\"${index}\" aria-label=\"Play Story\">\r\n                      <i class=\"fas fa-play\"></i>\r\n                    </button>\r\n                    <button class=\"btn btn-sm btn-danger deleteSavedStoryBtn\" data-title=\"${story.storyTitle}\" aria-label=\"Delete Story\">\r\n                      <i class=\"fas fa-trash-alt\"></i>\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            `);\r\n                        $listContainer.append(item);\r\n                    });\r\n                },\r\n                error: (xhr, statusText, errorThrown) => {\r\n                    Storage.handleAjaxError(xhr, statusText, errorThrown, 'Failed to load saved stories list');\r\n                }\r\n            });\r\n        },\r\n        createSavedStoryListItem: (story, index, dateStr) => {\r\n            return $(`\r\n        <div class=\"list-group-item p-2\">\r\n          <div class=\"d-flex justify-content-between align-items-center\">\r\n            <div>\r\n              <strong>${story.storyTitle || 'Untitled'}</strong><br>\r\n              <small>${story.storyAuthor || 'Unknown'} | ${dateStr}</small>\r\n            </div>\r\n            <div>\r\n              <button class=\"btn btn-sm btn-secondary editSavedStoryBtn\" data-index=\"${index}\" aria-label=\"Edit Story\">\r\n                <i class=\"fas fa-edit\"></i>\r\n              </button>\r\n              <button class=\"btn btn-sm btn-success loadSavedStoryBtn\" data-index=\"${index}\" aria-label=\"Play Story\">\r\n                <i class=\"fas fa-play\"></i>\r\n              </button>\r\n              <button class=\"btn btn-sm btn-danger deleteSavedStoryBtn\" data-title=\"${story.storyTitle}\" aria-label=\"Delete Story\">\r\n                <i class=\"fas fa-trash-alt\"></i>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      `);\r\n        },\r\n        loadSavedStory: (index, mode = \"edit\") => {\r\n            const stories = window.savedStories || [];\r\n            const story = stories[index];\r\n            if (!story) {\r\n                Swal.fire('Error', 'Story not found.', 'error');\r\n                return;\r\n            }\r\n            // NEW: If the story is locked, prompt for the password.\r\n            if (story.locked) {\r\n                Swal.fire({\r\n                    title: 'Enter Password',\r\n                    input: 'password',\r\n                    inputPlaceholder: 'Password',\r\n                    showCancelButton: true,\r\n                    inputAttributes: { autocapitalize: 'off', autocorrect: 'off' }\r\n                }).then(result => {\r\n                    if (result.value) {\r\n                        $.ajax({\r\n                            url: '/api/unlockstory',\r\n                            method: 'POST',\r\n                            contentType: 'application/json',\r\n                            data: JSON.stringify({ storyId: story._id, password: result.value }),\r\n                            success: (unlockedStory) => {\r\n                                Storage.populateEditorWithStory(unlockedStory, mode);\r\n                                currentStoryId = unlockedStory._id || null;\r\n                                $('#displayStoryId').text(currentStoryId);\r\n                                Swal.fire({ toast: true, position: 'top-end', icon: 'success', title: 'Story loaded!', showConfirmButton: false, timer: 1500 });\r\n                            },\r\n                            error: (xhr, statusText, errorThrown) => {\r\n                                Storage.handleAjaxError(xhr, statusText, errorThrown, 'Incorrect password or failed to unlock story');\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n            } else {\r\n                Storage.populateEditorWithStory(story, mode);\r\n                currentStoryId = story._id || null;\r\n                $('#displayStoryId').text(currentStoryId);\r\n                Swal.fire({ toast: true, position: 'top-end', icon: 'success', title: 'Story loaded!', showConfirmButton: false, timer: 1500 });\r\n            }\r\n        },\r\n\r\n\r\n        populateEditorWithStory: (story, mode) => {\r\n            $('#storyTitle').val(story.storyTitle);\r\n            $('#storyAuthor').val(story.storyAuthor);\r\n            $('#storyText').html(decodeHTMLEntities(story.storyText));\r\n            if (story.tags && story.tags.length) {\r\n                $('#storyTags').val(story.tags.join(', '));\r\n            }\r\n            if (mode === \"play\" && story.ratingCount) {\r\n                $('#ratingSection').show();\r\n            } else {\r\n                $('#ratingSection').hide();\r\n            }\r\n            // Reset and update state with the saved story's values\r\n            State.variables = [];\r\n            State.variableCounts = {};\r\n            State.insertionCounter = 0;\r\n            // --- FIX: Use the top-level keys from the saved story object ---\r\n            State.fillValues = story.fillValues || {};\r\n            State.pronounGroups = story.pronounGroups || {};\r\n            State.pronounGroupCount = story.pronounGroupCount || 0;\r\n            State.customPlaceholders = story.customPlaceholders || [];\r\n            updateVariablesFromEditor();\r\n    \r\n            if (mode === \"edit\") {\r\n                $('#editor').removeClass('d-none');\r\n                $('#inputs, #result').addClass('d-none');\r\n            } else if (mode === \"play\") {\r\n                buildFillForm();\r\n                $('#inputs').removeClass('d-none');\r\n                $('#editor, #result').addClass('d-none');\r\n            }\r\n        },\r\n        deleteSavedStory: (title) => {\r\n            $.ajax({\r\n                url: '/api/deletestory',\r\n                method: 'DELETE',\r\n                contentType: 'application/json',\r\n                data: JSON.stringify({ storyTitle: title }),\r\n                success: () => {\r\n                    Swal.fire({\r\n                        toast: true,\r\n                        position: 'top-end',\r\n                        icon: 'success',\r\n                        title: 'Story deleted!',\r\n                        showConfirmButton: false,\r\n                        timer: 1500\r\n                    });\r\n                    Storage.loadSavedStoriesList();\r\n                },\r\n                error: (xhr, statusText, errorThrown) => {\r\n                    Storage.handleAjaxError(xhr, statusText, errorThrown, 'Failed to delete story');\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    // ====================================================\r\n    // 4. TYPE HELPER FUNCTIONS\r\n    // ====================================================\r\n    const TypeHelpers = {\r\n        naturalizeType: (type) => {\r\n            if (type.startsWith(\"NNPS\")) {\r\n                let sub = type.substring(4);\r\n                if (sub.startsWith(\"_\")) sub = sub.substring(1);\r\n                sub = sub.replace(/\\d+$/, '');\r\n                if (sub.toLowerCase() === \"person\") {\r\n                    return \"Person (proper, plural)\";\r\n                }\r\n                return Utils.toTitleCase(Utils.naturalDisplay(sub || \"Proper Noun\")) + \" (Plural)\";\r\n            }\r\n            if (type.startsWith(\"NNP\")) {\r\n                let sub = type.substring(3);\r\n                if (sub.startsWith(\"_\")) sub = sub.substring(1);\r\n                sub = sub.replace(/\\d+$/, '');\r\n                if (sub.toLowerCase() === \"person\") {\r\n                    return \"Person (proper, singular)\";\r\n                }\r\n                return Utils.toTitleCase(Utils.naturalDisplay(sub || \"Proper Noun\")) + \" (Singular)\";\r\n            }\r\n            if (type.startsWith(\"NNS\")) {\r\n                let sub = type.substring(3);\r\n                if (sub.startsWith(\"_\")) sub = sub.substring(1);\r\n                sub = sub.replace(/\\d+$/, '');\r\n                if (sub.toLowerCase() === \"person\") {\r\n                    return \"Person (common, plural)\";\r\n                }\r\n                return Utils.toTitleCase(Utils.naturalDisplay(sub || \"Common Noun\")) + \" (Plural)\";\r\n            }\r\n            if (type.startsWith(\"NN\")) {\r\n                let sub = type.substring(2);\r\n                if (sub.startsWith(\"_\")) sub = sub.substring(1);\r\n                sub = sub.replace(/\\d+$/, '');\r\n                if (sub.toLowerCase() === \"person\") {\r\n                    return \"Person (common, singular)\";\r\n                }\r\n                return Utils.toTitleCase(Utils.naturalDisplay(sub || \"Common Noun\")) + \" (Singular)\";\r\n            }\r\n            if (type.startsWith(\"NNS\")) {\r\n                let sub = type.substring(3);\r\n                if (sub.startsWith(\"_\")) sub = sub.substring(1);\r\n                sub = sub.replace(/\\d+$/, '');\r\n                return Utils.toTitleCase(Utils.naturalDisplay(sub || \"Common Noun\")) + \" (Plural)\";\r\n            }\r\n            if (type.startsWith(\"NN\")) {\r\n                let sub = type.substring(2);\r\n                if (sub.startsWith(\"_\")) sub = sub.substring(1);\r\n                sub = sub.replace(/\\d+$/, '');\r\n                return Utils.toTitleCase(Utils.naturalDisplay(sub || \"Common Noun\")) + \" (Singular)\";\r\n            }\r\n            if (type === \"Onomatopoeia\") return \"Onomatopoeia\";\r\n            if (type.startsWith(\"MD_\")) {\r\n                let tense = type.substring(3);\r\n                let tenseNatural = \"\";\r\n                switch (tense) {\r\n                    case \"VB\": tenseNatural = \"Base (run)\"; break;\r\n                    case \"VBP\": tenseNatural = \"Present (I walk)\"; break;\r\n                    case \"VBZ\": tenseNatural = \"3rd Person (he leaves)\"; break;\r\n                    case \"VBD\": tenseNatural = \"Past (slept)\"; break;\r\n                    case \"VBG\": tenseNatural = \"Gerund (crying)\"; break;\r\n                    case \"VBN\": tenseNatural = \"Past Participle (eaten)\"; break;\r\n                    default: tenseNatural = tense;\r\n                }\r\n                return \"Modal Verb (\" + tenseNatural + \")\";\r\n            }\r\n            const verbTenseMap = {\r\n                \"VBZ\": \"3rd Person (he leaves)\",\r\n                \"VBD\": \"Past Tense (slept)\",\r\n                \"VBG\": \"Gerund (crying)\",\r\n                \"VBN\": \"Past Participle (eaten)\",\r\n                \"VBP\": \"Present (I walk)\"\r\n            };\r\n            for (let tense in verbTenseMap) {\r\n                if (type.startsWith(tense)) {\r\n                    let remainder = type.substring(tense.length);\r\n                    let category = \"\";\r\n                    if (remainder.startsWith(\"_\")) {\r\n                        category = remainder.substring(1);\r\n                    }\r\n                    return category\r\n                        ? Utils.toTitleCase(category) + \" Verb (\" + verbTenseMap[tense] + \")\"\r\n                        : \"Verb (\" + verbTenseMap[tense] + \")\";\r\n                }\r\n            }\r\n            if (type.startsWith(\"VB\")) {\r\n                let rest = type.substring(2).replace(/^_+/, \"\");\r\n                return rest ? Utils.toTitleCase(rest) + \" Verb (Base Form)\" : \"Verb (Base Form)\";\r\n            }\r\n            if (type.startsWith(\"JJ_\")) {\r\n                let sub = type.substring(3);\r\n                return Utils.toTitleCase(Utils.naturalDisplay(sub));\r\n            }\r\n            if (type.startsWith(\"JJS_\")) {\r\n                let sub = type.substring(4);\r\n                if (sub.toLowerCase() === \"ordinal\") {\r\n                    return \"Ordinal Number\";\r\n                }\r\n                return Utils.toTitleCase(Utils.naturalDisplay(sub)) + \" Superlative Adjective\";\r\n            }\r\n            if (type === \"JJ\") return \"Adjective\";\r\n            if (type === \"JJR\") return \"Comparative Adjective\";\r\n            if (type === \"JJS\") return \"Superlative Adjective\";\r\n            if (type === \"RB\") return \"Adverb\";\r\n            if (type === \"RBR\") return \"Comparative Adverb\";\r\n            if (type === \"RBS\") return \"Superlative Adverb\";\r\n            if (type === \"WRB\") return \"WH-adverb\";\r\n            if (type === \"CC\") return \"Coordinating Conjunction\";\r\n            if (type === \"PDT\") return \"Pre-determiner\";\r\n            if (type === \"WDT\") return \"WH-determiner\";\r\n            if (type === \"FW\") return \"Foreign Word\";\r\n            if (type === \"Number\") return \"Number\";\r\n            if (type === \"Exclamation\") return \"Exclamation\";\r\n            return type;\r\n        },\r\n        getTooltipForType: (type) => {\r\n            const normalizedType = type.trim().toLowerCase();\r\n            for (let category in allPlaceholders) {\r\n                for (let p of allPlaceholders[category]) {\r\n                    if (p.internalType.trim().toLowerCase() === normalizedType) {\r\n                        return p.tooltip;\r\n                    }\r\n                }\r\n            }\r\n            const verbTensePrefixes = [\"VBZ\", \"VBD\", \"VBG\", \"VBN\", \"VBP\"];\r\n            for (let prefix of verbTensePrefixes) {\r\n                if (normalizedType.startsWith(prefix.toLowerCase() + \"_\")) {\r\n                    const baseType = \"vb_\" + normalizedType.substring(prefix.length + 1);\r\n                    for (let category in allPlaceholders) {\r\n                        for (let p of allPlaceholders[category]) {\r\n                            if (p.internalType.trim().toLowerCase() === baseType) {\r\n                                return p.tooltip;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return \"No additional info available.\";\r\n        },\r\n        getOriginalDisplayForType: (type) => {\r\n            for (let category in allPlaceholders) {\r\n                for (let p of allPlaceholders[category]) {\r\n                    if (p.internalType === type) {\r\n                        return p.display;\r\n                    }\r\n                }\r\n            }\r\n            return type.startsWith(\"NN\") ? TypeHelpers.naturalizeType(type) : type;\r\n        },\r\n        guessTypeFromId: (id) => {\r\n            let base = id.replace(/\\d+$/, '');\r\n            const custom = State.customPlaceholders.find(p => p.type === base);\r\n            if (custom) return custom.type;\r\n            const pronounFixedRe = /^PRP(\\d+)(SUB|OBJ|PSA|PSP|REF)$/;\r\n            if (pronounFixedRe.test(id)) {\r\n                const match = id.match(pronounFixedRe);\r\n                const groupNum = match[1];\r\n                const abbrev = match[2];\r\n                const formMapReverse = { SUB: \"subject\", OBJ: \"object\", PSA: \"possAdj\", PSP: \"possPron\", REF: \"reflexive\" };\r\n                return `PRONOUN|PronounGroup${groupNum}|${formMapReverse[abbrev]}`;\r\n            }\r\n            const pronounRe = /^([A-Za-z0-9]+)_(subject|object|possAdj|possPron|reflexive)$/;\r\n            if (pronounRe.test(base)) {\r\n                const m = base.match(pronounRe);\r\n                return `PRONOUN|${m[1]}|${m[2]}`;\r\n            }\r\n            return TypeHelpers.naturalizeType(base);\r\n        },\r\n        getNounFinalType: (baseInternal, number) => {\r\n            let baseTag = \"\", extra = \"\";\r\n            if (baseInternal.indexOf(\"_\") !== -1) {\r\n                const parts = baseInternal.split(\"_\");\r\n                baseTag = parts[0];\r\n                extra = parts.slice(1).join(\"_\");\r\n            } else {\r\n                baseTag = baseInternal;\r\n            }\r\n            let finalTag = baseTag === \"NN\" ? (number === \"Singular\" ? \"NN\" : \"NNS\")\r\n                : baseTag === \"NNP\" ? (number === \"Singular\" ? \"NNP\" : \"NNPS\")\r\n                    : (number === \"Singular\" ? baseTag : baseTag + \"S\");\r\n            return extra ? finalTag + \"_\" + extra : finalTag;\r\n        },\r\n        computeFinalVerbType: (baseInternal, tenseTag) => {\r\n            if (baseInternal === \"MD\") return \"MD_\" + tenseTag;\r\n            const parts = baseInternal.split(\"_\");\r\n            const baseCategory = parts.slice(1).join(\"_\");\r\n            return baseCategory ? tenseTag + \"_\" + baseCategory : tenseTag;\r\n        }\r\n    };\r\n\r\n    // ====================================================\r\n    // 5. PLACEHOLDER DEFINITIONS & CATEGORY ORDER\r\n    // ====================================================\r\n    const categoryOrder = [\"Nouns\", \"Verbs\", \"Descriptors\", \"Other\"];\r\n    const allPlaceholders = {\r\n        \"Nouns\": [\r\n            { internalType: \"NN\", display: \"Noun\", tooltip: \"Generic noun (table, apple)\", icon: \"fas fa-book\", isPrimary: true },\r\n            { internalType: \"NNP\", display: \"Proper Noun\", tooltip: \"Specific name (London, Sarah)\", icon: \"fas fa-user\", isPrimary: false },\r\n            { internalType: \"PRONOUN\", display: \"Pronoun\", tooltip: \"A pronoun\", icon: \"fas fa-user-circle\", isPrimary: true },\r\n            { internalType: \"NN_Concrete\", display: \"Concrete\", tooltip: \"Tangible object (chair, phone)\", icon: \"fas fa-cube\", isPrimary: false },\r\n            { internalType: \"NN_Person\", display: \"Person\", tooltip: \"A person (teacher, doctor)\", icon: \"fas fa-user-friends\", isPrimary: true },\r\n            { internalType: \"NN_Place\", display: \"Place\", tooltip: \"A location (park, school)\", icon: \"fas fa-map-marker-alt\", isPrimary: true },\r\n            { internalType: \"NN_Abstract\", display: \"Abstract\", tooltip: \"Intangible (happiness, freedom)\", icon: \"fas fa-cloud\", isPrimary: true },\r\n            { internalType: \"NN_Animal\", display: \"Animal\", tooltip: \"Living creature (dog, elephant)\", icon: \"fas fa-dog\", isPrimary: false },\r\n            { internalType: \"NN_BodyPart\", display: \"Body Part\", tooltip: \"Part of body (hand, knee)\", icon: \"fas fa-hand-paper\", isPrimary: false },\r\n            { internalType: \"NN_Clothing\", display: \"Clothing\", tooltip: \"Wearable (shirt, jacket)\", icon: \"fas fa-tshirt\", isPrimary: false },\r\n            { internalType: \"NN_Drink\", display: \"Drink\", tooltip: \"Beverage (juice, coffee)\", icon: \"fas fa-cocktail\", isPrimary: false },\r\n            { internalType: \"NN_Emotion\", display: \"Emotion\", tooltip: \"Feeling (joy, anger)\", icon: \"fas fa-heart\", isPrimary: false },\r\n            { internalType: \"NN_Food\", display: \"Food\", tooltip: \"Edible item (pizza, carrot)\", icon: \"fas fa-utensils\", isPrimary: false },\r\n            { internalType: \"NN_Vehicle\", display: \"Vehicle\", tooltip: \"Mode of transport (car, bicycle)\", icon: \"fas fa-car\", isPrimary: false },\r\n            { internalType: \"NN_Onomatopoeia\", display: \"Sound/Onomatopoeia\", tooltip: \"Sound word (bang, buzz)\", icon: \"fas fa-volume-up\", isPrimary: false }\r\n        ],\r\n        \"Verbs\": [\r\n            { internalType: \"VB\", display: \"Verb\", tooltip: \"Action/state (jump, write)\", icon: \"fas fa-pen\", isPrimary: true },\r\n            { internalType: \"VB_Intransitive\", display: \"Intransitive\", tooltip: \"No object (sleep, arrive)\", icon: \"fas fa-bed\", isPrimary: true },\r\n            { internalType: \"VB_Transitive\", display: \"Transitive\", tooltip: \"Takes object (kick, carry)\", icon: \"fas fa-hammer\", isPrimary: true },\r\n            { internalType: \"VB_Action\", display: \"Action\", tooltip: \"Physical action (run, climb)\", icon: \"fas fa-bolt\", isPrimary: false },\r\n            { internalType: \"VB_Stative\", display: \"State\", tooltip: \"Condition (believe, know)\", icon: \"fas fa-brain\", isPrimary: false },\r\n            { internalType: \"VB_Communication\", display: \"Communication\", tooltip: \"Speaking (say, shout)\", icon: \"fas fa-comment-dots\", isPrimary: false },\r\n            { internalType: \"VB_Movement\", display: \"Movement\", tooltip: \"Motion-based (walk, swim)\", icon: \"fas fa-walking\", isPrimary: false },\r\n            { internalType: \"VB_Onomatopoeia\", display: \"Sound/Onomatopoeia\", tooltip: \"Sound verb (meow, boom)\", icon: \"fas fa-volume-up\", isPrimary: false },\r\n            { internalType: \"MD\", display: \"Modal\", tooltip: \"Possibility (can, must)\", icon: \"fas fa-key\", isPrimary: false },\r\n            { internalType: \"VB_Linking\", display: \"Linking\", tooltip: \"Links subject (seem, become)\", icon: \"fas fa-link\", isPrimary: false },\r\n            { internalType: \"VB_Phrase\", display: \"Phrasal Verb\", tooltip: \"Multi-word verb (give up, look after)\", icon: \"fas fa-random\", isPrimary: false }\r\n        ],\r\n        \"Descriptors\": [\r\n            { internalType: \"JJ\", display: \"Adjective\", tooltip: \"Describes noun (blue, tall)\", icon: \"fas fa-ad\", isPrimary: true },\r\n            { internalType: \"RB\", display: \"Adverb\", tooltip: \"Modifies verb (quickly, often)\", icon: \"fas fa-feather-alt\", isPrimary: true },\r\n            { internalType: \"JJR\", display: \"Comparative\", tooltip: \"Comparison (faster, smaller)\", icon: \"fas fa-level-up-alt\", isPrimary: false },\r\n            { internalType: \"JJS\", display: \"Superlative\", tooltip: \"Highest degree (best, tallest)\", icon: \"fas fa-medal\", isPrimary: false },\r\n            { internalType: \"JJ_Number\", display: \"Ordered Number\", tooltip: \"A ranked number (1st, seventh)\", icon: \"fas fa-hashtag\", isPrimary: true }\r\n        ],\r\n        \"Other\": [\r\n            { internalType: \"IN\", display: \"Preposition\", tooltip: \"Shows relation (in, under)\", icon: \"fas fa-arrows-alt\", isPrimary: false },\r\n            { internalType: \"DT\", display: \"Determiner\", tooltip: \"Specifier (a, the)\", icon: \"fas fa-bookmark\", isPrimary: false },\r\n            { internalType: \"CC\", display: \"Conjunction\", tooltip: \"Joins clauses (and, or)\", icon: \"fas fa-link\", isPrimary: false },\r\n            { internalType: \"FW\", display: \"Foreign Word\", tooltip: \"Non-English (bonjour, sushi)\", icon: \"fas fa-globe\", isPrimary: false },\r\n            { internalType: \"Number\", display: \"Number\", tooltip: \"Numerical (five, twenty)\", icon: \"fas fa-hashtag\", isPrimary: true },\r\n            { internalType: \"Exclamation\", display: \"Exclamation\", tooltip: \"Interjection (wow, oops)\", icon: \"fas fa-bullhorn\", isPrimary: true }\r\n        ]\r\n    };\r\n\r\n    // ====================================================\r\n    // 6. PLACEHOLDER & FORM HANDLING FUNCTIONS\r\n    // ====================================================\r\n    const insertNodeAtCaret = (node, range) => {\r\n        if (range) {\r\n            range.deleteContents();\r\n            range.insertNode(node);\r\n            const newRange = document.createRange();\r\n            newRange.setStartAfter(node);\r\n            newRange.collapse(true);\r\n            const sel = window.getSelection();\r\n            sel.removeAllRanges();\r\n            sel.addRange(newRange);\r\n        } else {\r\n            const sel = window.getSelection();\r\n            if (sel.rangeCount) {\r\n                const r = sel.getRangeAt(0);\r\n                r.deleteContents();\r\n                r.insertNode(node);\r\n                r.setStartAfter(node);\r\n                r.collapse(true);\r\n                sel.removeAllRanges();\r\n                sel.addRange(r);\r\n            }\r\n        }\r\n    };\r\n\r\n    const insertPlaceholderSpan = (placeholderID, displayText, range) => {\r\n        const span = document.createElement(\"span\");\r\n        span.className = \"placeholder\";\r\n        span.setAttribute(\"data-id\", placeholderID);\r\n        span.setAttribute(\"title\", placeholderID);\r\n        span.setAttribute(\"contenteditable\", \"false\");\r\n        span.textContent = displayText;\r\n        insertNodeAtCaret(span, range);\r\n\r\n        // Append extra space if needed\r\n        if (!displayText.endsWith(\" \")) {\r\n            if (span.parentNode) {\r\n                let nextNode = span.nextSibling;\r\n                if (nextNode && nextNode.nodeType === Node.TEXT_NODE) {\r\n                    if (!/^\\s/.test(nextNode.textContent)) {\r\n                        span.parentNode.insertBefore(document.createTextNode(\" \"), nextNode);\r\n                    }\r\n                } else if (nextNode) {\r\n                    span.parentNode.insertBefore(document.createTextNode(\" \"), nextNode);\r\n                } else {\r\n                    span.parentNode.appendChild(document.createTextNode(\" \"));\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    const duplicatePlaceholder = (variable) => {\r\n        State.usageTracker[variable.id] = (State.usageTracker[variable.id] || 0) + 1;\r\n        const newId = variable.id;\r\n        const editor = document.getElementById(\"storyText\");\r\n        let rangeToUse = (State.lastRange && editor.contains(State.lastRange.commonAncestorContainer))\r\n            ? State.lastRange\r\n            : (() => {\r\n                ensureEditorFocus();\r\n                const sel = window.getSelection();\r\n                return sel.rangeCount ? sel.getRangeAt(0) : null;\r\n            })();\r\n        const displayText = variable.displayOverride || variable.officialDisplay;\r\n        insertPlaceholderSpan(newId, displayText, rangeToUse);\r\n        State.lastRange = null;\r\n    };\r\n\r\n    const ensureEditorFocus = () => {\r\n        const editor = document.getElementById(\"storyText\");\r\n        const sel = window.getSelection();\r\n        if (!sel.rangeCount || !editor.contains(sel.anchorNode)) {\r\n            editor.focus();\r\n            const range = document.createRange();\r\n            range.selectNodeContents(editor);\r\n            range.collapse(false);\r\n            sel.removeAllRanges();\r\n            sel.addRange(range);\r\n        }\r\n    };\r\n\r\n    const insertPlaceholder = async (internalType, displayName, isCustom) => {\r\n        const sanitized = Utils.sanitizeString(internalType);\r\n        const editor = document.getElementById(\"storyText\");\r\n        const spans = editor.querySelectorAll(\".placeholder\");\r\n        let max = 0;\r\n        spans.forEach(span => {\r\n            const id = span.getAttribute(\"data-id\");\r\n            if (id.startsWith(sanitized)) {\r\n                const match = id.match(/(\\d+)$/);\r\n                if (match) {\r\n                    const num = parseInt(match[1], 10);\r\n                    if (num > max) max = num;\r\n                }\r\n            }\r\n        });\r\n        const newCount = max + 1;\r\n        State.variableCounts[sanitized] = newCount;\r\n        const id = sanitized + newCount;\r\n        let rangeToUse = (State.lastRange && editor.contains(State.lastRange.commonAncestorContainer))\r\n            ? State.lastRange\r\n            : (() => {\r\n                ensureEditorFocus();\r\n                const sel = window.getSelection();\r\n                return sel.rangeCount ? sel.getRangeAt(0) : null;\r\n            })();\r\n        let selectedText = \"\";\r\n        if (rangeToUse && !rangeToUse.collapsed) {\r\n            selectedText = rangeToUse.toString().trim();\r\n        }\r\n        let displayText = selectedText || displayName;\r\n        if (!selectedText) {\r\n            const { value: temp } = await Swal.fire({\r\n                title: 'Enter temporary word',\r\n                input: 'text',\r\n                inputLabel: 'Temporary fill word for this placeholder',\r\n                inputValue: displayName,\r\n                showCancelButton: true\r\n            });\r\n            if (temp) displayText = temp;\r\n        }\r\n        insertPlaceholderSpan(id, displayText, rangeToUse);\r\n        if (!State.variables.some(v => v.id === id)) {\r\n            State.variables.push({\r\n                id,\r\n                internalType,\r\n                officialDisplay: displayName,\r\n                display: displayName,\r\n                isCustom: !!isCustom,\r\n                order: State.insertionCounter++,\r\n                displayOverride: displayText\r\n            });\r\n        }\r\n        updateVariablesList();\r\n        State.lastRange = null;\r\n        if (internalType.startsWith(\"NN\") && selectedText) {\r\n            Swal.fire({\r\n                title: 'Apply placeholder to all occurrences?',\r\n                text: `Replace all instances of \"${selectedText}\" with this placeholder?`,\r\n                icon: 'question',\r\n                showCancelButton: true,\r\n                confirmButtonText: 'Yes, apply',\r\n                cancelButtonText: 'No'\r\n            }).then(result => {\r\n                if (result.isConfirmed) {\r\n                    applyPlaceholderToAllOccurrences(selectedText, id, displayText);\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    const insertPronounPlaceholderSimple = (groupId, form, tempValue) => {\r\n        const editor = document.getElementById(\"storyText\");\r\n        ensureEditorFocus();\r\n        const sel = window.getSelection();\r\n        const range = (State.lastRange && editor.contains(State.lastRange.commonAncestorContainer))\r\n            ? State.lastRange\r\n            : (sel.rangeCount ? sel.getRangeAt(0) : null);\r\n        const groupNum = groupId.replace('PronounGroup', '');\r\n        const formAbbrevMap = { subject: 'SUB', object: 'OBJ', possAdj: 'PSA', possPron: 'PSP', reflexive: 'REF' };\r\n        const abbrev = formAbbrevMap[form] || form.toUpperCase();\r\n        const placeholderId = `PRP${groupNum}${abbrev}`;\r\n        if (!State.variables.some(v => v.id === placeholderId)) {\r\n            const displayType = `Person (${form})`;\r\n            State.variables.push({\r\n                id: placeholderId,\r\n                internalType: `PRONOUN|${groupId}|${form}`,\r\n                officialDisplay: displayType,\r\n                display: displayType,\r\n                isCustom: false,\r\n                order: State.insertionCounter++,\r\n                displayOverride: tempValue\r\n            });\r\n            updateVariablesList();\r\n        }\r\n        insertPlaceholderSpan(placeholderId, tempValue, range);\r\n        State.lastRange = null;\r\n    };\r\n\r\n    const choosePronounTempValue = (form, groupId) => {\r\n        return Swal.fire({\r\n            title: 'Select Temporary Pronoun',\r\n            input: 'radio',\r\n            inputOptions: {\r\n                'He/Him': 'He/Him',\r\n                'She/Her': 'She/Her',\r\n                'They/Them': 'They/Them',\r\n                'Custom': 'Custom'\r\n            },\r\n            inputValidator: (value) => {\r\n                if (!value) return 'You need to choose an option!';\r\n            }\r\n        }).then(result => {\r\n            if (result.value === 'Custom') {\r\n                return Swal.fire({\r\n                    title: 'Enter custom temporary pronoun',\r\n                    input: 'text',\r\n                    inputLabel: 'Temporary pronoun',\r\n                    inputValue: form,\r\n                    showCancelButton: true\r\n                }).then(res => res.value || form);\r\n            } else {\r\n                return result.value;\r\n            }\r\n        });\r\n    };\r\n\r\n    const formatLabel = (variable) =>\r\n        variable.displayOverride && variable.displayOverride !== variable.officialDisplay\r\n            ? `${variable.displayOverride} (${variable.officialDisplay})`\r\n            : variable.officialDisplay;\r\n\r\n    const updateVariablesList = () => {\r\n        const container = document.getElementById('existingPlaceholdersContainer');\r\n        container.innerHTML = '';\r\n        State.variables.sort((a, b) =>\r\n            (State.usageTracker[b.id] || 0) - (State.usageTracker[a.id] || 0) || a.order - b.order\r\n        );\r\n        State.variables.forEach(v => {\r\n            const btn = document.createElement('button');\r\n            btn.type = 'button';\r\n            btn.className = 'btn btn-outline-secondary btn-sm m-1 placeholder-item';\r\n            btn.setAttribute('data-id', v.id);\r\n            btn.textContent = v.displayOverride || v.officialDisplay;\r\n            btn.setAttribute('title', v.id);\r\n            container.appendChild(btn);\r\n        });\r\n    };\r\n\r\n    // ====================================================\r\n    // 7. UPDATE PLACEHOLDER ACCORDION\r\n    // ====================================================\r\n    const updatePlaceholderAccordion = (accordionSelector, noResultsSelector, searchVal = '') => {\r\n        if (noResultsSelector === \"#noResults\") {\r\n            $(\"#searchQuery\").text(searchVal);\r\n            $(\"#searchQueryBtn\").text(searchVal);\r\n        } else if (noResultsSelector === \"#modalNoResults\") {\r\n            $(\"#modalSearchQuery\").text(searchVal);\r\n            $(\"#modalSearchQueryBtn\").text(searchVal);\r\n        }\r\n        $(noResultsSelector).hide();\r\n        const accordion = $(accordionSelector);\r\n        accordion.empty();\r\n        categoryOrder.forEach(categoryName => {\r\n            const placeholders = allPlaceholders[categoryName] || [];\r\n            if (placeholders.length > 0) {\r\n                const categoryCard = createPlaceholderCategoryCard(categoryName, accordionSelector, placeholders, searchVal);\r\n                accordion.append(categoryCard);\r\n            }\r\n        });\r\n        if (State.customPlaceholders.length > 0) {\r\n            const customCard = createCustomPlaceholderCategoryCard(accordionSelector, searchVal);\r\n            accordion.append(customCard);\r\n        }\r\n        if (searchVal) {\r\n            const anyShown = accordion.find('.placeholder-btn:visible').length > 0;\r\n            $(noResultsSelector).toggle(!anyShown);\r\n            accordion.find('.card-header, .show-more-toggle').hide();\r\n        } else {\r\n            accordion.find('.card-header, .show-more-toggle').show();\r\n        }\r\n    };\r\n\r\n    const createPlaceholderCategoryCard = (categoryName, accordionSelector, placeholders, searchVal) => {\r\n        const sanitizedCategoryName = categoryName.replace(/\\s+/g, '');\r\n        const card = $(`<div class='card'></div>`);\r\n        card.append(createCardHeader(categoryName, sanitizedCategoryName, accordionSelector));\r\n        const collapseDiv = $(`\r\n      <div id='${sanitizedCategoryName}Collapse' class='collapse show' aria-labelledby='${sanitizedCategoryName}Heading' data-parent='${accordionSelector}'>\r\n        <div class='card-body'><div class='list-group'></div></div>\r\n      </div>\r\n    `);\r\n        const primaryItems = placeholders.filter(p => p.isPrimary);\r\n        const secondaryItems = placeholders.filter(p => !p.isPrimary);\r\n        primaryItems.forEach(p => appendPlaceholderItem(collapseDiv.find('.list-group'), p, searchVal));\r\n        if (secondaryItems.length > 0) {\r\n            const secondaryPlaceholderWrapper = createSecondaryPlaceholderWrapper(secondaryItems, searchVal);\r\n            collapseDiv.find('.list-group').append(secondaryPlaceholderWrapper);\r\n            collapseDiv.find('.list-group').append(createShowMoreToggle(sanitizedCategoryName));\r\n            updateShowMoreToggleVisibility(collapseDiv, searchVal, secondaryPlaceholderWrapper);\r\n        }\r\n        card.append(collapseDiv);\r\n        return card;\r\n    };\r\n\r\n    const createCustomPlaceholderCategoryCard = (accordionSelector, searchVal) => {\r\n        const card = $(`<div class='card'></div>`);\r\n        card.append(createCardHeader('Custom Placeholders', 'CustomPlaceholders', accordionSelector));\r\n        const collapseDiv = $(`\r\n      <div id='CustomPlaceholdersCollapse' class='collapse show' aria-labelledby='CustomPlaceholdersHeading' data-parent='${accordionSelector}'>\r\n        <div class='card-body'><div class='list-group'></div></div>\r\n      </div>\r\n    `);\r\n        State.customPlaceholders.forEach(p => {\r\n            const showItem = !searchVal || p.type.toLowerCase().includes(searchVal.toLowerCase());\r\n            const item = $(`\r\n        <div class='list-group-item placeholder-btn custom-placeholder'\r\n          data-internal='${p.type}'\r\n          data-display='${p.type}'\r\n          style='display: ${showItem ? 'block' : 'none'};'>\r\n          <i class='fas fa-star'></i> ${p.type}\r\n        </div>\r\n      `);\r\n            collapseDiv.find('.list-group').append(item);\r\n        });\r\n        card.append(collapseDiv);\r\n        return card;\r\n    };\r\n\r\n    const createCardHeader = (categoryName, sanitizedCategoryName, accordionSelector) => {\r\n        return $(`\r\n      <div class='card-header' id='${sanitizedCategoryName}Heading'>\r\n        <h2 class='mb-0'>\r\n          <button class='btn btn-link btn-block text-left' type='button'\r\n            data-toggle='collapse' data-target='#${sanitizedCategoryName}Collapse'\r\n            aria-expanded='true' aria-controls='${sanitizedCategoryName}Collapse'>\r\n            ${categoryName}\r\n          </button>\r\n        </h2>\r\n      </div>\r\n    `);\r\n    };\r\n\r\n    const createSecondaryPlaceholderWrapper = (secondaryItems, searchVal) => {\r\n        const hiddenWrapper = $(`<div class='secondary-placeholder-wrapper'></div>`);\r\n        secondaryItems.forEach(p => appendPlaceholderItem(hiddenWrapper, p, searchVal, true));\r\n        return hiddenWrapper;\r\n    };\r\n\r\n    const createShowMoreToggle = (sanitizedCategoryName) => {\r\n        return $(`\r\n      <div class='show-more-toggle' data-category='${sanitizedCategoryName}'>\r\n        Show More\r\n      </div>\r\n    `);\r\n    };\r\n\r\n    const updateShowMoreToggleVisibility = (collapseDiv, searchVal, secondaryPlaceholderWrapper) => {\r\n        const toggleLink = collapseDiv.find('.show-more-toggle');\r\n        if (!searchVal) {\r\n            secondaryPlaceholderWrapper.find('.secondary-placeholder').hide();\r\n            toggleLink.text('Show More');\r\n        } else {\r\n            let anySecondaryVisible = secondaryPlaceholderWrapper.find('.secondary-placeholder:visible').length > 0;\r\n            toggleLink.text(anySecondaryVisible ? 'Show Less' : 'Show More');\r\n        }\r\n    };\r\n\r\n    const appendPlaceholderItem = (listGroup, placeholder, searchVal, isSecondary = false) => {\r\n        const showItem = !searchVal || placeholder.display.toLowerCase().includes(searchVal.toLowerCase());\r\n        const item = $(`\r\n      <div class='list-group-item placeholder-btn${isSecondary ? ' secondary-placeholder' : ''}'\r\n        data-internal='${placeholder.internalType}'\r\n        data-display='${placeholder.display}'\r\n        style='display: ${showItem ? 'block' : 'none'};'>\r\n        <i class='${placeholder.icon}'></i> ${placeholder.display}\r\n        <i class='fas fa-info-circle accordion-info-icon' data-tooltip=\"${placeholder.tooltip}\" style=\"font-size:0.8em; margin-left:5px;\"></i>\r\n      </div>\r\n    `);\r\n        listGroup.append(item);\r\n    };\r\n\r\n    // ====================================================\r\n    // 8. PLACEHOLDER SELECTION & INFO ICON HANDLERS\r\n    // ====================================================\r\n    $(document).on('click', '.accordion-info-icon', (e) => {\r\n        e.stopPropagation();\r\n        const tooltip = $(e.currentTarget).data('tooltip');\r\n        Swal.fire({\r\n            toast: true,\r\n            position: 'top-end',\r\n            icon: 'info',\r\n            title: tooltip,\r\n            showConfirmButton: false,\r\n            timer: 1500,\r\n            timerProgressBar: true\r\n        });\r\n    });\r\n    $(document).on('click', '.fill-info-icon', (e) => {\r\n        e.stopPropagation();\r\n        const type = $(e.currentTarget).data('type');\r\n        const tooltip = TypeHelpers.getTooltipForType(type);\r\n        Swal.fire({\r\n            toast: true,\r\n            position: 'top-end',\r\n            icon: 'info',\r\n            title: tooltip,\r\n            showConfirmButton: false,\r\n            timer: 1500,\r\n            timerProgressBar: true\r\n        });\r\n    });\r\n    $(document).on('click', '.show-more-toggle', function () {\r\n        const parentList = $(this).closest('.list-group');\r\n        const hiddenItems = parentList.find('.secondary-placeholder-wrapper .secondary-placeholder');\r\n        const link = $(this);\r\n        link.text(link.text() === 'Show More' ? 'Show Less' : 'Show More');\r\n        hiddenItems.toggle();\r\n    });\r\n\r\n    // ====================================================\r\n    // 9. CUSTOM PLACEHOLDER HANDLERS & SAVED STORIES SORTING\r\n    // ====================================================\r\n    const addNewCustomPlaceholderWithUsage = (rawText, usage) => {\r\n        let internal;\r\n        if (usage === \"noun\") {\r\n            internal = \"NN_\" + Utils.pascalCase(rawText);\r\n        } else if (usage === \"verb\") {\r\n            internal = \"VB_\" + Utils.pascalCase(rawText);\r\n        } else {\r\n            internal = Utils.pascalCase(rawText);\r\n        }\r\n        if (!State.customPlaceholders.some(p => p.type === internal)) {\r\n            State.customPlaceholders.push({ type: internal });\r\n        }\r\n    };\r\n    const addNewCustomPlaceholder = (rawText) => {\r\n        const internal = Utils.pascalCase(rawText);\r\n        if (!State.customPlaceholders.some(p => p.type === internal)) {\r\n            State.customPlaceholders.push({ type: internal });\r\n        }\r\n    };\r\n    const insertPlaceholderFromCustom = (rawText) => {\r\n        const internal = Utils.pascalCase(rawText);\r\n        const display = Utils.naturalDisplay(internal);\r\n        insertPlaceholder(internal, display, true);\r\n    };\r\n    $('#addCustomPlaceholderBtn').on('click', () => {\r\n        const raw = $('#placeholderSearch').val();\r\n        const usage = $('input[name=\"customPlaceholderType\"]:checked').val() || \"generic\";\r\n        if (usage === \"noun\") {\r\n            addNewCustomPlaceholderWithUsage(raw, \"noun\");\r\n            showNounNumberSelection(\"NN_\" + Utils.pascalCase(raw), Utils.naturalDisplay(raw));\r\n        } else if (usage === \"verb\") {\r\n            addNewCustomPlaceholderWithUsage(raw, \"verb\");\r\n            showVerbTenseSelection(\"VB_\" + Utils.pascalCase(raw), Utils.naturalDisplay(raw));\r\n        } else {\r\n            addNewCustomPlaceholder(raw);\r\n            insertPlaceholderFromCustom(raw);\r\n        }\r\n        $('#placeholderSearch').val('');\r\n        updatePlaceholderAccordion('#placeholderAccordion', '#noResults', currentPlaceholderSearch);\r\n    });\r\n    $('#modalAddCustomPlaceholderBtn').on('click', () => {\r\n        const raw = $('#modalPlaceholderSearch').val();\r\n        const usage = $('input[name=\"modalCustomPlaceholderType\"]:checked').val() || \"generic\";\r\n        if (usage === \"noun\") {\r\n            addNewCustomPlaceholderWithUsage(raw, \"noun\");\r\n            showNounNumberSelection(\"NN_\" + Utils.pascalCase(raw), Utils.naturalDisplay(raw));\r\n        } else if (usage === \"verb\") {\r\n            addNewCustomPlaceholderWithUsage(raw, \"verb\");\r\n            showVerbTenseSelection(\"VB_\" + Utils.pascalCase(raw), Utils.naturalDisplay(raw));\r\n        } else {\r\n            addNewCustomPlaceholder(raw);\r\n            insertPlaceholderFromCustom(raw);\r\n        }\r\n        updatePlaceholderAccordion('#modalPlaceholderAccordion', '#modalNoResults', currentModalPlaceholderSearch);\r\n        $('#placeholderModal').modal('hide');\r\n        $('#modalPlaceholderSearch').val('');\r\n        updatePlaceholderAccordion('#modalPlaceholderAccordion', '#modalNoResults', currentModalPlaceholderSearch);\r\n    });\r\n\r\n    $(document).on('click', '#modalPlaceholderAccordion .placeholder-btn', (e) => {\r\n        e.stopImmediatePropagation();\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n        if ($('#placeholderModal').hasClass('show')) {\r\n            $('#placeholderModal').modal('hide');\r\n        }\r\n        const internalType = $(e.currentTarget).data('internal');\r\n        const displayName = $(e.currentTarget).data('display');\r\n        if (internalType === \"PRONOUN\") {\r\n            pickPronounFormAndGroup();\r\n            $('#placeholderSearch').val('');\r\n            updatePlaceholderAccordion('#placeholderAccordion', '#noResults', currentPlaceholderSearch);\r\n            return;\r\n        }\r\n        if (internalType.indexOf(\"NN\") === 0) {\r\n            if (internalType === \"NN_Person\") {\r\n                // New step for person placeholders\r\n                showPersonTypeSelection(internalType, displayName);\r\n                $('#placeholderSearch').val('');\r\n                updatePlaceholderAccordion('#placeholderAccordion', '#noResults', currentPlaceholderSearch);\r\n                return;\r\n            }\r\n            // Otherwise, proceed as usual with number selection\r\n            showNounNumberSelection(internalType, displayName);\r\n            $('#placeholderSearch').val('');\r\n            updatePlaceholderAccordion('#placeholderAccordion', '#noResults', currentPlaceholderSearch);\r\n            return;\r\n        }\r\n        if (internalType.indexOf(\"VB\") === 0 || internalType === \"MD\") {\r\n            showVerbTenseSelection(internalType, displayName);\r\n            $('#placeholderSearch').val('');\r\n            updatePlaceholderAccordion('#placeholderAccordion', '#noResults', currentPlaceholderSearch);\r\n            return;\r\n        }\r\n        if (window.isEditingPlaceholder && currentEditingVariable) {\r\n            updateExistingPlaceholder(currentEditingVariable, internalType, displayName);\r\n            window.isEditingPlaceholder = false;\r\n            currentEditingVariable = null;\r\n        } else {\r\n            insertPlaceholder(internalType, displayName, false);\r\n        }\r\n        $('#placeholderSearch').val('');\r\n        updatePlaceholderAccordion('#placeholderAccordion', '#noResults', currentPlaceholderSearch);\r\n    });\r\n\r\n    $(document).on('click', '.placeholder-btn', (e) => {\r\n        if (State.placeholderInsertionInProgress) return;\r\n        State.placeholderInsertionInProgress = true;\r\n        if ($(e.currentTarget).closest('#modalPlaceholderAccordion').length > 0) {\r\n            State.placeholderInsertionInProgress = false;\r\n            return;\r\n        }\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n        const internalType = $(e.currentTarget).data('internal');\r\n        const displayName = $(e.currentTarget).data('display');\r\n        if (window.isEditingPlaceholder && currentEditingVariable) {\r\n            updateExistingPlaceholder(currentEditingVariable, internalType, displayName);\r\n            window.isEditingPlaceholder = false;\r\n            currentEditingVariable = null;\r\n            $('#placeholderModal').modal('hide');\r\n        } else {\r\n            if (internalType === \"PRONOUN\") {\r\n                pickPronounFormAndGroup();\r\n                $('#placeholderSearch').val('');\r\n                updatePlaceholderAccordion('#placeholderAccordion', '#noResults', currentPlaceholderSearch);\r\n                State.placeholderInsertionInProgress = false;\r\n                return;\r\n            }\r\n            if (internalType.indexOf(\"NN\") === 0) {\r\n                if (internalType === \"NN_Person\") {\r\n                    showPersonTypeSelection(internalType, displayName);\r\n                    $('#placeholderSearch').val('');\r\n                    updatePlaceholderAccordion('#placeholderAccordion', '#noResults', currentPlaceholderSearch);\r\n                    State.placeholderInsertionInProgress = false;\r\n                    return;\r\n                }\r\n                showNounNumberSelection(internalType, displayName);\r\n                $('#placeholderSearch').val('');\r\n                updatePlaceholderAccordion('#placeholderAccordion', '#noResults', currentPlaceholderSearch);\r\n                State.placeholderInsertionInProgress = false;\r\n                return;\r\n            }\r\n\r\n            if (internalType.indexOf(\"VB\") === 0 || internalType === \"MD\") {\r\n                showVerbTenseSelection(internalType, displayName);\r\n                $('#placeholderSearch').val('');\r\n                updatePlaceholderAccordion('#placeholderAccordion', '#noResults', currentPlaceholderSearch);\r\n                State.placeholderInsertionInProgress = false;\r\n                return;\r\n            }\r\n            insertPlaceholder(internalType, displayName, false);\r\n            $('#placeholderSearch').val('');\r\n            updatePlaceholderAccordion('#placeholderAccordion', '#noResults', currentPlaceholderSearch);\r\n        }\r\n        setTimeout(() => { State.placeholderInsertionInProgress = false; }, 50);\r\n    });\r\n\r\n    // ====================================================\r\n    // 10. VERB & NOUN SELECTION MODALS\r\n    // ====================================================\r\n    const showPersonTypeSelection = (baseInternal, baseDisplay) => {\r\n        let html = `<div class='list-group'>\r\n      <button class='list-group-item list-group-item-action person-type-btn' data-type='common'>\r\n        Common (e.g., doctor)\r\n      </button>\r\n      <button class='list-group-item list-group-item-action person-type-btn' data-type='proper'>\r\n        Proper (e.g., Donald Trump)\r\n      </button>\r\n    </div>`;\r\n        Swal.fire({\r\n            title: 'Select Person Type',\r\n            html,\r\n            showCancelButton: true,\r\n            showConfirmButton: false,\r\n            allowOutsideClick: false,\r\n            didOpen: () => {\r\n                const container = Swal.getHtmlContainer();\r\n                $(container).find('.person-type-btn').on('click', function () {\r\n                    const selectedType = $(this).data('type'); // \"common\" or \"proper\"\r\n                    let updatedBaseInternal, updatedBaseDisplay;\r\n                    if (selectedType === \"proper\") {\r\n                        updatedBaseInternal = \"NNP_Person\";\r\n                        updatedBaseDisplay = \"Proper \" + baseDisplay;\r\n                    } else {\r\n                        updatedBaseInternal = \"NN_Person\";\r\n                        updatedBaseDisplay = \"Common \" + baseDisplay;\r\n                    }\r\n                    // Close the current modal...\r\n                    Swal.close();\r\n                    // ...and use a small timeout to ensure it’s fully closed before showing the next modal.\r\n                    setTimeout(() => {\r\n                        showNounNumberSelection(updatedBaseInternal, updatedBaseDisplay);\r\n                    }, 100);\r\n                });\r\n            }\r\n        });\r\n    };\r\n\r\n\r\n    const showNounNumberSelection = (baseInternal, baseDisplay) => {\r\n        let html = `<div class='list-group'>`;\r\n        ['Singular', 'Plural'].forEach(f => {\r\n            html += `<button class='list-group-item list-group-item-action noun-number-btn' data-form='${f}'>${f}</button>`;\r\n        });\r\n        html += `</div>`;\r\n        Swal.fire({\r\n            title: 'Select Number',\r\n            html,\r\n            showCancelButton: true,\r\n            showConfirmButton: false,\r\n            didOpen: () => {\r\n                const container = Swal.getHtmlContainer();\r\n                $(container).find('.noun-number-btn').on('click', async function () {\r\n                    const selected = $(this).data('form');\r\n                    const finalInternal = TypeHelpers.getNounFinalType(baseInternal, selected);\r\n                    const finalDisplay = `${baseDisplay} (${selected})`;\r\n                    if (window.isEditingPlaceholder && currentEditingVariable) {\r\n                        updateExistingPlaceholder(currentEditingVariable, finalInternal, finalDisplay);\r\n                        window.isEditingPlaceholder = false;\r\n                        currentEditingVariable = null;\r\n                        Swal.close();\r\n                    } else {\r\n                        await insertPlaceholder(finalInternal, finalDisplay, false);\r\n                        Swal.close();\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    };\r\n\r\n    const VERB_TENSES = [\r\n        { value: 'VB', text: 'Base (run)' },\r\n        { value: 'VBP', text: 'Present (I walk)' },\r\n        { value: 'VBZ', text: 'Present 3rd (he leaves)' },\r\n        { value: 'VBD', text: 'Past (slept)' },\r\n        { value: 'VBG', text: 'Gerund (crying)' },\r\n        { value: 'VBN', text: 'Past Participle (eaten)' }\r\n    ];\r\n    const showVerbTenseSelection = (baseInternal, baseDisplay) => {\r\n        let html = `<div class='list-group'>`;\r\n        VERB_TENSES.forEach(t => {\r\n            html += `<button class='list-group-item list-group-item-action verb-tense-btn' data-tense='${t.value}' data-text='${t.text}'>${t.text}</button>`;\r\n        });\r\n        html += `</div>`;\r\n        Swal.fire({\r\n            title: 'Select Verb Tense',\r\n            html,\r\n            showCancelButton: true,\r\n            showConfirmButton: false,\r\n            didOpen: () => {\r\n                const container = Swal.getHtmlContainer();\r\n                $(container).find('.verb-tense-btn').on('click', async function () {\r\n                    const selectedTense = $(this).data('tense');\r\n                    const tenseText = $(this).data('text');\r\n                    const finalInternal = TypeHelpers.computeFinalVerbType(baseInternal, selectedTense);\r\n                    const finalDisplay = `${baseDisplay} (${tenseText})`;\r\n                    if (window.isEditingPlaceholder && currentEditingVariable) {\r\n                        updateExistingPlaceholder(currentEditingVariable, finalInternal, finalDisplay);\r\n                        window.isEditingPlaceholder = false;\r\n                        currentEditingVariable = null;\r\n                        Swal.close();\r\n                    } else {\r\n                        await insertPlaceholder(finalInternal, finalDisplay, false);\r\n                        Swal.close();\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    };\r\n\r\n    // ====================================================\r\n    // 11. PRONOUN HANDLERS\r\n    // ====================================================\r\n    const pickPronounFormAndGroup = () => {\r\n        const forms = [\r\n            { value: 'subject', text: 'Subject (he, she, they)' },\r\n            { value: 'object', text: 'Object (him, her, them)' },\r\n            { value: 'possAdj', text: 'Possessive Adj. (his, her, their)' },\r\n            { value: 'possPron', text: 'Possessive Pron. (his, hers)' },\r\n            { value: 'reflexive', text: 'Reflexive (himself, herself)' }\r\n        ];\r\n        let html = `<div class='list-group mb-2'>`;\r\n        forms.forEach(f => {\r\n            html += `<button class='list-group-item list-group-item-action pronoun-form-btn' data-form='${f.value}'>${f.text}</button>`;\r\n        });\r\n        html += `</div>`;\r\n        Swal.fire({\r\n            title: 'Pick a Pronoun Form',\r\n            html,\r\n            showCancelButton: true,\r\n            showConfirmButton: false,\r\n            didOpen: () => {\r\n                const container = Swal.getHtmlContainer();\r\n                $(container).find('.pronoun-form-btn').on('click', function () {\r\n                    const chosenForm = $(this).data('form');\r\n                    Swal.close();\r\n                    pickPronounGroup(chosenForm);\r\n                });\r\n            }\r\n        });\r\n    };\r\n\r\n    const pickPronounGroup = (form) => {\r\n        const groupKeys = Object.keys(pronounGroups);\r\n        let html = '';\r\n        if (groupKeys.length > 0) {\r\n            html += `<h5>Existing Pronoun Groups</h5><div class='list-group mb-2'>`;\r\n            groupKeys.forEach(g => {\r\n                html += `<button class='list-group-item list-group-item-action pronoun-group-btn' data-group='${g}'>${g}</button>`;\r\n            });\r\n            html += `</div><hr>`;\r\n        }\r\n        html += `<button class='btn btn-sm btn-outline-primary' id='createNewPronounGroupBtn'>Create New Group</button>`;\r\n        Swal.fire({\r\n            title: 'Pick a Pronoun Group',\r\n            html,\r\n            showCancelButton: true,\r\n            showConfirmButton: false,\r\n            didOpen: () => {\r\n                const container = Swal.getHtmlContainer();\r\n                $(container).find('.pronoun-group-btn').on('click', function () {\r\n                    const grp = $(this).data('group');\r\n                    Swal.close();\r\n                    if (State.pronounGroups[grp] && State.pronounGroups[grp][form]) {\r\n                        insertPronounPlaceholderSimple(grp, form, State.pronounGroups[grp][form]);\r\n                    } else {\r\n                        choosePronounTempValue(form, grp).then(tempValue => {\r\n                            State.pronounGroups[grp] = pronounMapping[tempValue] || { subject: tempValue, object: tempValue, possAdj: tempValue, possPron: tempValue, reflexive: tempValue };\r\n                            insertPronounPlaceholderSimple(grp, form, State.pronounGroups[grp][form]);\r\n                        });\r\n                    }\r\n                });\r\n                $(container).find('#createNewPronounGroupBtn').on('click', function () {\r\n                    State.pronounGroupCount++;\r\n                    const newGroup = `PronounGroup${State.pronounGroupCount}`;\r\n                    State.pronounGroups[newGroup] = {};\r\n                    Swal.close();\r\n                    choosePronounTempValue(form, newGroup).then(tempValue => {\r\n                        State.pronounGroups[newGroup] = pronounMapping[tempValue] || { subject: tempValue, object: tempValue, possAdj: tempValue, possPron: tempValue, reflexive: tempValue };\r\n                        insertPronounPlaceholderSimple(newGroup, form, State.pronounGroups[newGroup][form]);\r\n                    });\r\n                });\r\n            }\r\n        });\r\n    };\r\n\r\n    // ====================================================\r\n    // 12. BUILD THE FILL-IN-THE-BLANK FORM\r\n    // ====================================================\r\n    const buildFillForm = () => {\r\n        const form = $('#inputForm').empty();\r\n        appendPronounGroupsToForm(form);\r\n        appendNonPronounVariablesToForm(form);\r\n    };\r\n\r\n    const appendPronounGroupsToForm = (form) => {\r\n        const groupSet = getPronounGroups();\r\n        const sortedGroups = Array.from(groupSet).sort((a, b) => a.localeCompare(b));\r\n        if (sortedGroups.length > 0) {\r\n            form.append(`<h4>Pronouns</h4>`);\r\n            sortedGroups.forEach(g => {\r\n                const block = createPronounGroupBlock(g);\r\n                form.append(block);\r\n            });\r\n            form.on('change', \"input[type='radio']\", handlePronounChoiceChange);\r\n        }\r\n    };\r\n\r\n    const getPronounGroups = () => {\r\n        const groupSet = new Set();\r\n        for (const v of variables) {\r\n            if (v.internalType.startsWith('PRONOUN|')) {\r\n                const parts = v.internalType.split('|');\r\n                groupSet.add(parts[1]);\r\n            }\r\n        }\r\n        return groupSet;\r\n    };\r\n\r\n    const createPronounGroupBlock = (groupName) => {\r\n        const block = $(`\r\n      <div class='form-group'>\r\n        <label id='${groupName}-label' title=\"Hover to see internal ID\">\r\n          ${groupName} - Person (select pronoun)\r\n          <i class=\"fas fa-info-circle fill-info-icon\" data-type=\"${groupName}\" style=\"font-size:0.8em; margin-left:5px;\"></i>\r\n        </label>\r\n      </div>\r\n    `);\r\n        const radios = `\r\n      <div class='form-check'>\r\n        <input type='radio' class='form-check-input' name='${groupName}-choice' value='HeHim'>\r\n        <label class='form-check-label'>He/Him</label>\r\n      </div>\r\n      <div class='form-check'>\r\n        <input type='radio' class='form-check-input' name='${groupName}-choice' value='SheHer'>\r\n        <label class='form-check-label'>She/Her</label>\r\n      </div>\r\n      <div class='form-check'>\r\n        <input type='radio' class='form-check-input' name='${groupName}-choice' value='TheyThem'>\r\n        <label class='form-check-label'>They/Them</label>\r\n      </div>\r\n      <div class='form-check mb-2'>\r\n        <input type='radio' class='form-check-input' name='${groupName}-choice' value='Custom'>\r\n        <label class='form-check-label'>Custom</label>\r\n      </div>\r\n      <input type='text' class='form-control form-control-sm d-none' id='${groupName}-custom'\r\n        placeholder='comma-separated: subject, object, possAdj, possPron, reflexive'>\r\n    `;\r\n        block.append(radios);\r\n        return block;\r\n    };\r\n\r\n    const handlePronounChoiceChange = function () {\r\n        const groupName = $(this).attr('name').replace('-choice', '');\r\n        if ($(this).val() === 'Custom') {\r\n            $(`#${groupName}-custom`).removeClass('d-none');\r\n        } else {\r\n            $(`#${groupName}-custom`).addClass('d-none');\r\n        }\r\n    };\r\n\r\n    const appendNonPronounVariablesToForm = (form) => {\r\n        let nonPronounVars = State.variables.filter(v => !v.internalType.startsWith('PRONOUN|'));\r\n        if (State.fillOrder === 'alphabetical') {\r\n            nonPronounVars.sort((a, b) => a.officialDisplay.localeCompare(b.officialDisplay));\r\n        } else if (State.fillOrder === 'random') {\r\n            nonPronounVars.sort(() => Math.random() - 0.5);\r\n        }\r\n        nonPronounVars.forEach(variable => {\r\n            const groupRow = createInputRow(variable);\r\n            form.append(groupRow);\r\n        });\r\n    };\r\n\r\n    const createInputRow = (variable) => {\r\n        const groupRow = $(`\r\n      <div class=\"form-group input-row\">\r\n        <div class=\"row\">\r\n          <div class=\"col-sm-4\">\r\n            <label class=\"input-label\" title=\"Internal ID: ${variable.id}\">\r\n              ${variable.officialDisplay}\r\n            </label>\r\n          </div>\r\n          <div class=\"col-sm-8\">\r\n            <input type=\"text\"\r\n              class=\"form-control form-control-sm compact-input\"\r\n              name=\"${variable.id}\"\r\n              data-label=\"${variable.officialDisplay}\">\r\n          </div>\r\n        </div>\r\n      </div>\r\n    `);\r\n        if (State.fillValues[variable.id]) {\r\n            groupRow.find('input').val(State.fillValues[variable.id]);\r\n        }\r\n        return groupRow;\r\n    };\r\n\r\n    // ====================================================\r\n    // 13. EVENT HANDLERS & DOCUMENT READY\r\n    // ====================================================\r\n    $(document).ready(() => {\r\n        // Attach search handlers with a reduced debounce delay (50ms)\r\n        $('#placeholderSearch').on('input', Utils.debounce(function () {\r\n            const searchVal = $(this).val();\r\n            updatePlaceholderAccordion('#placeholderAccordion', '#noResults', searchVal);\r\n            $('#addCustomPlaceholderBtn').text('Add \"' + searchVal + '\"');\r\n        }, 50));\r\n\r\n        $('#modalPlaceholderSearch').on('input', Utils.debounce(function () {\r\n            const searchVal = $(this).val();\r\n            updatePlaceholderAccordion('#modalPlaceholderAccordion', '#modalNoResults', searchVal);\r\n            $('#modalAddCustomPlaceholderBtn').text('Add \"' + searchVal + '\"');\r\n        }, 50));\r\n\r\n        updatePlaceholderAccordion('#placeholderAccordion', '#noResults', currentPlaceholderSearch);\r\n        updatePlaceholderAccordion('#modalPlaceholderAccordion', '#modalNoResults', currentModalPlaceholderSearch);\r\n        $('#filterTag').on('input', Utils.debounce(() => {\r\n            Storage.loadSavedStoriesList();\r\n        }, 300));\r\n\r\n        $('#sortOption').on('change', () => {\r\n            Storage.loadSavedStoriesList();\r\n        });\r\n\r\n        // Attach event handlers for the ordering buttons\r\n        $('#alphabeticalOrderBtn').on('click', function () {\r\n            // Set the fill order to alphabetical\r\n            State.fillOrder = 'alphabetical';\r\n            // Update button styling (optional)\r\n            $(this).removeClass('btn-outline-secondary').addClass('btn-outline-primary');\r\n            $('#randomOrderBtn').removeClass('btn-outline-primary').addClass('btn-outline-secondary');\r\n            // Rebuild the fill form to reflect the new order\r\n            buildFillForm();\r\n        });\r\n\r\n        $('#randomOrderBtn').on('click', function () {\r\n            // Set the fill order to random\r\n            State.fillOrder = 'random';\r\n            // Update button styling (optional)\r\n            $(this).removeClass('btn-outline-secondary').addClass('btn-outline-primary');\r\n            $('#alphabeticalOrderBtn').removeClass('btn-outline-primary').addClass('btn-outline-secondary');\r\n            // Rebuild the fill form to reflect the new order\r\n            buildFillForm();\r\n        });\r\n\r\n        // NEW: Attach autocomplete to the tag filter input in the saved stories modal.\r\n        $(\"#filterTag\").autocomplete({\r\n            source: function (request, response) {\r\n                $.ajax({\r\n                    url: '/api/gettags',\r\n                    method: 'GET',\r\n                    dataType: 'json',\r\n                    success: (tags) => {\r\n                        const filteredTags = $.ui.autocomplete.filter(tags, request.term);\r\n                        response(filteredTags);\r\n                    },\r\n                    error: (err) => {\r\n                        console.error('Failed to load tags for autocomplete', err);\r\n                        response([]);\r\n                    }\r\n                });\r\n            },\r\n            minLength: 1,\r\n            select: (event, ui) => {\r\n                $(\"#filterTag\").val(ui.item.value);\r\n                $(\"#applyFilters\").click();\r\n                return false;\r\n            }\r\n        });\r\n\r\n        // NEW: Event handler for applying filters in the saved stories modal.\r\n        $('#applyFilters').on('click', () => {\r\n            Storage.loadSavedStoriesList();\r\n        });\r\n\r\n        $('#shareStory').on('click', () => {\r\n            const finalText = $('#finalStory').text();\r\n            const title = $('#displayTitle').text();\r\n            const author = $('#displayAuthor').text();\r\n            const content = `Title: ${title}\\nAuthor: ${author}\\n\\n${finalText}`;\r\n            if (navigator.clipboard && navigator.clipboard.writeText) {\r\n                navigator.clipboard.writeText(content)\r\n                    .then(() => {\r\n                        Swal.fire({\r\n                            toast: true,\r\n                            position: 'top-end',\r\n                            icon: 'success',\r\n                            title: 'Story copied to clipboard!',\r\n                            showConfirmButton: false,\r\n                            timer: 1500\r\n                        });\r\n                    })\r\n                    .catch(err => {\r\n                        console.error('Error copying text: ', err);\r\n                        fallbackCopyTextToClipboard(content);\r\n                    });\r\n            } else {\r\n                fallbackCopyTextToClipboard(content);\r\n            }\r\n        });\r\n\r\n        const fallbackCopyTextToClipboard = (text) => {\r\n            const textarea = document.createElement('textarea');\r\n            textarea.value = text;\r\n            textarea.style.position = 'fixed';\r\n            textarea.style.top = '-9999px';\r\n            document.body.appendChild(textarea);\r\n            textarea.focus();\r\n            textarea.select();\r\n            try {\r\n                const successful = document.execCommand('copy');\r\n                if (successful) {\r\n                    Swal.fire({\r\n                        toast: true,\r\n                        position: 'top-end',\r\n                        icon: 'success',\r\n                        title: 'Story copied to clipboard!',\r\n                        showConfirmButton: false,\r\n                        timer: 1500\r\n                    });\r\n                } else {\r\n                    Swal.fire('Error', 'Failed to copy story. Please copy manually.', 'error');\r\n                }\r\n            } catch (err) {\r\n                Swal.fire('Error', 'Failed to copy story. Please copy manually.', 'error');\r\n            }\r\n            document.body.removeChild(textarea);\r\n        };\r\n\r\n        document.getElementById('existingPlaceholdersContainer').addEventListener('click', (e) => {\r\n            const btn = e.target.closest('.placeholder-item');\r\n            if (!btn) return;\r\n            const id = btn.getAttribute('data-id');\r\n            const variable = State.variables.find(v => v.id === id);\r\n            if (variable) duplicatePlaceholder(variable);\r\n        });\r\n\r\n        $('#storyText').on('input', () => {\r\n            updateVariablesFromEditor();\r\n            State.storyHasUnsavedChanges = true;\r\n        });\r\n\r\n        $('#uploadStoryBtn').on('click', () => { $('#uploadStory').click(); });\r\n        $('#uploadStory').on('change', function () {\r\n            const file = this.files[0];\r\n            if (!file) return;\r\n            const reader = new FileReader();\r\n            reader.onload = (e) => {\r\n                const content = e.target.result;\r\n                const titleMatch = content.match(/^Title:\\s*(.*)$/m);\r\n                const authorMatch = content.match(/^Author:\\s*(.*)$/m);\r\n                const storyStartIndex = content.indexOf('\\n\\n');\r\n                const storyContent = storyStartIndex !== -1 ? content.substring(storyStartIndex + 2) : content;\r\n                $('#storyTitle').val(titleMatch ? titleMatch[1] : '');\r\n                $('#storyAuthor').val(authorMatch ? authorMatch[1] : '');\r\n                $('#storyText').html(storyContent);\r\n                State.variables = [];\r\n                State.variableCounts = {};\r\n                State.insertionCounter = 0;\r\n                State.pronounGroupCount = 0;\r\n                State.pronounGroups = {};\r\n                State.fillValues = {};\r\n                State.customPlaceholders = [];\r\n                updateVariablesFromEditor();\r\n            };\r\n            reader.readAsText(file);\r\n        });\r\n\r\n        $('#startGame').on('click', () => {\r\n            const content = $('#storyText').html();\r\n            if (!content.trim()) {\r\n                Swal.fire('Oops!', 'Please write a story.', 'error');\r\n                return;\r\n            }\r\n            updateVariablesFromEditor();\r\n            State.storyText = generateLegacyText();\r\n            if (!State.variables.length) {\r\n                Swal.fire('Oops!', 'No placeholders found.', 'error');\r\n                return;\r\n            }\r\n            buildFillForm();\r\n            $('#inputs').removeClass('d-none');\r\n            $('#editor').addClass('d-none');\r\n        });\r\n\r\n        $('#generateStory').on('click', () => {\r\n            const inputs = $('#inputForm input[type=\"text\"]:not(.d-none)');\r\n            let valid = true;\r\n            inputs.each(function () {\r\n                const pid = $(this).attr('name');\r\n                if (!pid) return;\r\n                const val = $(this).val().trim();\r\n                const label = $(this).attr('data-label');\r\n                if (!val && pid) {\r\n                    Swal.fire('Oops!', `Please enter a value for ${label}.`, 'error');\r\n                    valid = false;\r\n                    return false;\r\n                }\r\n                State.fillValues[pid] = val;\r\n            });\r\n            if (!valid) return;\r\n            let pronounComplete = true;\r\n            const groupSet = new Set();\r\n            for (const v of variables) {\r\n                if (v.internalType.startsWith('PRONOUN|')) {\r\n                    const parts = v.internalType.split('|');\r\n                    groupSet.add(parts[1]);\r\n                }\r\n            }\r\n            groupSet.forEach(g => {\r\n                $(`#${g}-label .required-asterisk`).remove();\r\n                const choice = $(`input[name='${g}-choice']:checked`).val();\r\n                if (!choice) {\r\n                    pronounComplete = false;\r\n                    $(`#${g}-label`).append(\"<span class='required-asterisk' style='color:red;'> *</span>\");\r\n                } else if (choice === 'Custom') {\r\n                    const raw = $(`#${g}-custom`).val().trim();\r\n                    const splitted = raw.split(',').map(s => s.trim());\r\n                    if (splitted.length !== 5 || splitted.some(s => s === \"\")) {\r\n                        pronounComplete = false;\r\n                        $(`#${g}-label`).append(\"<span class='required-asterisk' style='color:red;'> *</span>\");\r\n                    }\r\n                }\r\n            });\r\n            if (!pronounComplete) {\r\n                Swal.fire(\"Oops!\", \"Please complete all pronoun selections.\", \"error\");\r\n                return;\r\n            }\r\n            groupSet.forEach(g => {\r\n                const choice = $(`input[name='${g}-choice']:checked`).val();\r\n                if (choice === 'HeHim' || choice === 'SheHer' || choice === 'TheyThem') {\r\n                    const predefined = {\r\n                        HeHim: { subject: \"he\", object: \"him\", possAdj: \"his\", possPron: \"his\", reflexive: \"himself\" },\r\n                        SheHer: { subject: \"she\", object: \"her\", possAdj: \"her\", possPron: \"hers\", reflexive: \"herself\" },\r\n                        TheyThem: { subject: \"they\", object: \"them\", possAdj: \"their\", possPron: \"theirs\", reflexive: \"themselves\" }\r\n                    };\r\n                    State.pronounGroups[g] = { ...predefined[choice] };\r\n                } else {\r\n                    const raw = $(`#${g}-custom`).val().trim();\r\n                    const splitted = raw.split(',').map(s => s.trim());\r\n                    State.pronounGroups[g] = {\r\n                        subject: splitted[0],\r\n                        object: splitted[1],\r\n                        possAdj: splitted[2],\r\n                        possPron: splitted[3],\r\n                        reflexive: splitted[4],\r\n                    };\r\n                }\r\n            });\r\n            // FIX: Regenerate the legacy story text from the editor here\r\n            let final = generateLegacyText();\r\n            for (const v of variables) {\r\n                const phRegex = new RegExp(`\\\\{${v.id}\\\\}`, 'g');\r\n                if (v.internalType.startsWith('PRONOUN|')) {\r\n                    const parts = v.internalType.split('|');\r\n                    const groupId = parts[1];\r\n                    const form = parts[2];\r\n                    const groupObj = State.pronounGroups[groupId];\r\n                    final = final.replace(phRegex, groupObj ? (groupObj[form] || '') : '');\r\n                } else {\r\n                    const userVal = State.fillValues[v.id] || '';\r\n                    final = final.replace(phRegex, userVal);\r\n                }\r\n            }\r\n            $('#finalStory').text(final);\r\n            $('#displayTitle').text($('#storyTitle').val());\r\n            $('#displayAuthor').text($('#storyAuthor').val());\r\n            // NEW: Display tags in the result (if any)\r\n            $('#displayTags').text($('#storyTags').val());\r\n            $('#result').removeClass('d-none');\r\n            $('#inputs').addClass('d-none');\r\n        });\r\n\r\n\r\n        $('#createNewStory2, #createNewStory').on('click', (e) => {\r\n            e.preventDefault();\r\n            if (storyHasUnsavedChanges) {\r\n                Swal.fire({\r\n                    title: 'Unsaved changes',\r\n                    text: 'Your story has unsaved changes. Would you like to save it to the site before starting a new one?',\r\n                    icon: 'warning',\r\n                    showDenyButton: true,\r\n                    showCancelButton: true,\r\n                    confirmButtonText: 'Save and start new',\r\n                    denyButtonText: 'Discard changes'\r\n                }).then((result) => {\r\n                    if (result.isConfirmed) {\r\n                        Storage.addCurrentStoryToSavedStories();\r\n                        setTimeout(createNewStory, 1000);\r\n                    } else if (result.isDenied) {\r\n                        Swal.fire({\r\n                            title: 'Are you sure?',\r\n                            text: 'This will discard your current unsaved story.',\r\n                            icon: 'warning',\r\n                            showCancelButton: true,\r\n                            confirmButtonText: 'Yes, start new',\r\n                            cancelButtonText: 'Cancel'\r\n                        }).then((res) => {\r\n                            if (res.isConfirmed) createNewStory();\r\n                        });\r\n                    }\r\n                });\r\n            } else {\r\n                Swal.fire({\r\n                    title: 'Are you sure?',\r\n                    text: 'This will discard your current story.',\r\n                    icon: 'warning',\r\n                    showCancelButton: true,\r\n                    confirmButtonText: 'Yes, start new',\r\n                    cancelButtonText: 'Cancel'\r\n                }).then((res) => {\r\n                    if (res.isConfirmed) createNewStory();\r\n                });\r\n            }\r\n        });\r\n\r\n        const createNewStory = () => {\r\n            $('#storyTitle').val('');\r\n            $('#storyAuthor').val('');\r\n            $('#storyText').html('');\r\n            $('#storyTags').val(''); // NEW: clear tags field\r\n            State.variables = [];\r\n            State.variableCounts = {};\r\n            State.insertionCounter = 0;\r\n            State.customPlaceholders = [];\r\n            State.fillValues = {};\r\n            State.pronounGroups = {};\r\n            State.pronounGroupCount = 0;\r\n            State.storyHasUnsavedChanges = false;\r\n            updateVariablesList();\r\n            updatePlaceholderAccordion('#placeholderAccordion', '#noResults', currentPlaceholderSearch);\r\n            updatePlaceholderAccordion('#modalPlaceholderAccordion', '#modalNoResults', currentModalPlaceholderSearch);\r\n            $('#editor').removeClass('d-none');\r\n            $('#inputs, #result').addClass('d-none');\r\n        };\r\n\r\n        $('#editStoryEntries').on('click', () => {\r\n            buildFillForm();\r\n            $('#result').addClass('d-none');\r\n            $('#inputs').removeClass('d-none');\r\n        });\r\n        $('#backToEditor, #backToEditor2').on('click', () => {\r\n            $('#result, #inputs').addClass('d-none');\r\n            $('#editor').removeClass('d-none');\r\n        });\r\n        function loadPreexistingTags() {\r\n            $.ajax({\r\n                url: '/api/gettags',\r\n                method: 'GET',\r\n                success: (tags) => {\r\n                    let container = $('#preexistingTagsContainer');\r\n                    container.empty();\r\n                    if (tags.length > 0) {\r\n                        container.append('<p>Select a tag:</p>');\r\n                        tags.forEach(tag => {\r\n                            const btn = $('<button type=\"button\" class=\"btn btn-sm btn-outline-secondary m-1 preexisting-tag-btn\"></button>');\r\n                            btn.text(tag);\r\n                            btn.on('click', () => {\r\n                                let current = $('#swalTags').val();\r\n                                let tagsArr = current ? current.split(',').map(t => t.trim()).filter(Boolean) : [];\r\n                                if (!tagsArr.includes(tag)) {\r\n                                    tagsArr.push(tag);\r\n                                    $('#swalTags').val(tagsArr.join(', '));\r\n                                }\r\n                            });\r\n                            container.append(btn);\r\n                        });\r\n                    }\r\n                },\r\n                error: (err) => {\r\n                    console.error('Failed to load preexisting tags', err);\r\n                }\r\n            });\r\n        }\r\n        $('#saveStoryToSite').on('click', () => {\r\n            Swal.fire({\r\n                title: 'Save Story',\r\n                html: `\r\n          <input type=\"text\" id=\"swalTitle\" class=\"swal2-input\" placeholder=\"Story Title\" value=\"${$('#storyTitle').val()}\">\r\n          <input type=\"text\" id=\"swalAuthor\" class=\"swal2-input\" placeholder=\"Author\" value=\"${$('#storyAuthor').val()}\">\r\n          <input type=\"text\" id=\"swalTags\" class=\"swal2-input\" placeholder=\"Tags (comma separated)\" value=\"${$('#storyTags').val()}\">\r\n          <input type=\"password\" id=\"swalPassword\" class=\"swal2-input\" placeholder=\"Password (optional)\">\r\n          <div id=\"preexistingTagsContainer\" style=\"text-align:left; margin-top:10px;\"></div>\r\n        `,\r\n                didOpen: () => {\r\n                    loadPreexistingTags();\r\n                },\r\n                showCancelButton: true,\r\n                confirmButtonText: 'Save',\r\n                preConfirm: () => {\r\n                    return {\r\n                        title: document.getElementById('swalTitle').value,\r\n                        author: document.getElementById('swalAuthor').value,\r\n                        tags: document.getElementById('swalTags').value,\r\n                        password: document.getElementById('swalPassword').value\r\n                    };\r\n                }\r\n            }).then((result) => {\r\n                if (result.isConfirmed) {\r\n                    const data = result.value;\r\n                    // Update fields in the editor\r\n                    $('#storyTitle').val(data.title);\r\n                    $('#storyAuthor').val(data.author);\r\n                    $('#storyTags').val(data.tags);\r\n\r\n                    let story = {\r\n                        storyTitle: data.title,\r\n                        storyAuthor: data.author,\r\n                        storyText: $('#storyText').html(),\r\n                        variables: State.variables,\r\n                        pronounGroups: State.pronounGroups,\r\n                        variableCounts: State.variableCounts,\r\n                        pronounGroupCount: State.pronounGroupCount,\r\n                        customPlaceholders: State.customPlaceholders,\r\n                        tags: data.tags ? data.tags.split(',').map(s => s.trim()) : [],\r\n                        savedAt: new Date().toISOString(),\r\n                        password: null\r\n                    };\r\n\r\n                    $.ajax({\r\n                        url: '/api/savestory',\r\n                        method: 'POST',\r\n                        contentType: 'application/json',\r\n                        data: JSON.stringify(story),\r\n                        success: () => {\r\n                            Swal.fire({\r\n                                toast: true,\r\n                                position: 'top-end',\r\n                                icon: 'success',\r\n                                title: 'Story saved to site!',\r\n                                showConfirmButton: false,\r\n                                timer: 1500\r\n                            });\r\n                        },\r\n                        error: (xhr, statusText, errorThrown) => {\r\n                            Storage.handleAjaxError(xhr, statusText, errorThrown, 'Failed to save story');\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n        });\r\n\r\n\r\n\r\n        $('#downloadStory').on('click', () => {\r\n            const finalText = $('#finalStory').text();\r\n            const title = $('#displayTitle').text();\r\n            const author = $('#displayAuthor').text();\r\n            const content = `Title: ${title}\\nAuthor: ${author}\\n\\n${finalText}`;\r\n            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });\r\n            const url = URL.createObjectURL(blob);\r\n            const a = document.createElement('a');\r\n            a.href = url;\r\n            const fileName = title ? title.replace(/[^a-z0-9]/gi, '_').toLowerCase() + '.txt' : 'story.txt';\r\n            a.download = fileName;\r\n            document.body.appendChild(a);\r\n            a.click();\r\n            document.body.removeChild(a);\r\n            URL.revokeObjectURL(url);\r\n        });\r\n        $('#mySavedStoriesBtn').on('click', () => {\r\n            Storage.loadSavedStoriesList();\r\n            $('#savedStoriesModal').modal('show');\r\n        });\r\n        $(document).on('click', '.loadSavedStoryBtn', function () {\r\n            const index = $(this).data('index');\r\n            $('#savedStoriesModal').modal('hide');\r\n            Storage.loadSavedStory(index, \"play\");\r\n        });\r\n        $(document).on('click', '.editSavedStoryBtn', function () {\r\n            const index = $(this).data('index');\r\n            $('#savedStoriesModal').modal('hide');\r\n            Storage.loadSavedStory(index, \"edit\");\r\n        });\r\n        $(document).on('click', '.deleteSavedStoryBtn', function () {\r\n            const title = $(this).data('title');\r\n            Swal.fire({\r\n                title: 'Delete Story?',\r\n                text: 'Are you sure you want to delete this saved story?',\r\n                icon: 'warning',\r\n                showCancelButton: true,\r\n                confirmButtonText: 'Yes, delete it!'\r\n            }).then((result) => {\r\n                if (result.isConfirmed) Storage.deleteSavedStory(title);\r\n            });\r\n        });\r\n\r\n        // NEW: Rating submission for completed story.\r\n        $('#submitRating').on('click', () => {\r\n            const rating = parseInt($('#storyRating').val(), 10);\r\n            if (!currentStoryId) {\r\n                Swal.fire('Error', 'Story ID not found.', 'error');\r\n                return;\r\n            }\r\n            $.ajax({\r\n                url: '/api/rateStory',\r\n                method: 'POST',\r\n                contentType: 'application/json',\r\n                data: JSON.stringify({ storyId: currentStoryId, rating }),\r\n                success: (data) => {\r\n                    Swal.fire({\r\n                        toast: true,\r\n                        position: 'top-end',\r\n                        icon: 'success',\r\n                        title: `Thank you for rating! New average: ${data.rating.toFixed(1)} (${data.ratingCount} votes)`,\r\n                        showConfirmButton: false,\r\n                        timer: 1500\r\n                    });\r\n                },\r\n                error: (xhr, statusText, errorThrown) => {\r\n                    Storage.handleAjaxError(xhr, statusText, errorThrown, 'Failed to rate story');\r\n                }\r\n            });\r\n        });\r\n\r\n        $('#storyText').on('keydown', (e) => {\r\n            const sel = window.getSelection();\r\n            if (sel.rangeCount) {\r\n                let range = sel.getRangeAt(0);\r\n                if (e.key === \"ArrowRight\") {\r\n                    let node = sel.anchorNode;\r\n                    if (node.nodeType === Node.TEXT_NODE && node.parentNode.classList.contains('placeholder')) {\r\n                        if (sel.anchorOffset >= node.nodeValue.length) {\r\n                            e.preventDefault();\r\n                            let placeholder = node.parentNode;\r\n                            let newRange = document.createRange();\r\n                            newRange.setStartAfter(placeholder);\r\n                            newRange.collapse(true);\r\n                            sel.removeAllRanges();\r\n                            sel.addRange(newRange);\r\n                        }\r\n                    }\r\n                }\r\n                if (e.key === \"Backspace\") {\r\n                    let node = sel.anchorNode;\r\n                    if (node.nodeType === Node.TEXT_NODE && node.parentNode.classList.contains('placeholder') && sel.anchorOffset === 0) {\r\n                        e.preventDefault();\r\n                        let placeholder = node.parentNode;\r\n                        let newRange = document.createRange();\r\n                        newRange.setStartBefore(placeholder);\r\n                        newRange.collapse(true);\r\n                        sel.removeAllRanges();\r\n                        sel.addRange(newRange);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        $('#addPlaceholderBtn').on('click', () => { $('#placeholderModal').modal('show'); });\r\n    });\r\n\r\n    // ====================================================\r\n    // 14. GLOBALS & HELPER FUNCTIONS FOR THE NEW FEATURES\r\n    // ====================================================\r\n    let currentEditingVariable = null;\r\n    let currentPlaceholderElement = null;\r\n\r\n    const positionMenu = (menu, rect) => {\r\n        menu.style.display = 'block';\r\n        const menuWidth = menu.offsetWidth;\r\n        const menuHeight = menu.offsetHeight;\r\n        const offset = 5;\r\n        let desiredTop = (rect.bottom + offset + menuHeight <= window.innerHeight)\r\n            ? window.scrollY + rect.bottom + offset\r\n            : window.scrollY + rect.top - menuHeight - offset;\r\n        let desiredLeft = window.scrollX + rect.left + (rect.width / 2) - (menuWidth / 2);\r\n        desiredLeft = Math.max(window.scrollX + 5, Math.min(desiredLeft, window.scrollX + window.innerWidth - menuWidth - 5));\r\n        menu.style.top = desiredTop + 'px';\r\n        menu.style.left = desiredLeft + 'px';\r\n    };\r\n\r\n    const hideMenu = (menu) => { menu.style.display = 'none'; };\r\n    const hideAllMenus = () => { hideMenu(selectionMenu); hideMenu(placeholderEditMenu); };\r\n\r\n    const selectionMenu = document.createElement('div');\r\n    selectionMenu.id = 'textSelectionMenu';\r\n    Object.assign(selectionMenu.style, {\r\n        position: 'absolute',\r\n        display: 'none',\r\n        zIndex: '1000',\r\n        background: '#fff',\r\n        border: '1px solid #ccc',\r\n        padding: '5px',\r\n        borderRadius: '4px',\r\n        boxShadow: '0px 2px 4px rgba(0,0,0,0.2)'\r\n    });\r\n    selectionMenu.innerHTML = `\r\n    <button id=\"newPlaceholderBtn\" class=\"btn btn-sm btn-primary\">New Placeholder</button>\r\n    <button id=\"reusePlaceholderBtn\" class=\"btn btn-sm btn-secondary\">Reuse Placeholder</button>\r\n  `;\r\n    document.body.appendChild(selectionMenu);\r\n\r\n    const placeholderEditMenu = document.createElement('div');\r\n    placeholderEditMenu.id = 'placeholderEditMenu';\r\n    Object.assign(placeholderEditMenu.style, {\r\n        position: 'absolute',\r\n        display: 'none',\r\n        zIndex: '1000',\r\n        background: '#fff',\r\n        border: '1px solid #ccc',\r\n        padding: '5px',\r\n        borderRadius: '4px',\r\n        boxShadow: '0px 2px 4px rgba(0,0,0,0.2)'\r\n    });\r\n    placeholderEditMenu.innerHTML = `\r\n    <button id=\"editPlaceholderBtn\" class=\"btn btn-sm btn-primary\">Change Placeholder</button>\r\n    <button id=\"editOverrideBtn\" class=\"btn btn-sm btn-secondary\">Change Override</button>\r\n    <button id=\"deletePlaceholderBtn\" class=\"btn btn-sm btn-danger\">Delete</button>\r\n  `;\r\n    document.body.appendChild(placeholderEditMenu);\r\n\r\n    // After the creation of placeholderEditMenu and before the end of the IIFE,\r\n    // add a click event listener on the story text to detect clicks on placeholder spans\r\n    document.getElementById('storyText').addEventListener('click', function (e) {\r\n        if (e.target.classList.contains('placeholder')) {\r\n            // Stop propagation so that other handlers (e.g. selection menu) do not interfere\r\n            e.stopPropagation();\r\n            // Find the corresponding variable using the data-id attribute\r\n            currentEditingVariable = State.variables.find(v => v.id === e.target.getAttribute('data-id'));\r\n            currentPlaceholderElement = e.target;\r\n            // Position the placeholder edit menu near the clicked element\r\n            positionMenu(placeholderEditMenu, e.target.getBoundingClientRect());\r\n        }\r\n    });\r\n\r\n    // Now attach event listeners to the buttons in the placeholderEditMenu\r\n    document.getElementById('editPlaceholderBtn').addEventListener('click', () => {\r\n        hideMenu(placeholderEditMenu);\r\n        window.isEditingPlaceholder = true;\r\n        // Open the modal so the user can select a new placeholder type.\r\n        // (The modal’s click handler will check window.isEditingPlaceholder and update the existing placeholder.)\r\n        $('#placeholderModal').modal('show');\r\n        // Clear the current editing variable after the action is initiated\r\n        currentEditingVariable = null;\r\n        currentPlaceholderElement = null;\r\n    });\r\n\r\n    document.getElementById('editOverrideBtn').addEventListener('click', async () => {\r\n        hideMenu(placeholderEditMenu);\r\n        const { value: newOverride } = await Swal.fire({\r\n            title: 'Change Override',\r\n            input: 'text',\r\n            inputLabel: 'Enter new override text',\r\n            inputValue: currentPlaceholderElement ? currentPlaceholderElement.textContent : ''\r\n        });\r\n        if (newOverride !== undefined) {\r\n            if (currentPlaceholderElement) {\r\n                currentPlaceholderElement.textContent = newOverride;\r\n            }\r\n            if (currentEditingVariable) {\r\n                currentEditingVariable.displayOverride = newOverride;\r\n            }\r\n            updateVariablesList();\r\n        }\r\n        currentEditingVariable = null;\r\n        currentPlaceholderElement = null;\r\n    });\r\n\r\n    document.getElementById('deletePlaceholderBtn').addEventListener('click', () => {\r\n        hideMenu(placeholderEditMenu);\r\n        if (currentPlaceholderElement) {\r\n            currentPlaceholderElement.remove();\r\n        }\r\n        updateVariablesFromEditor();\r\n        currentEditingVariable = null;\r\n        currentPlaceholderElement = null;\r\n    });\r\n\r\n    document.getElementById('storyText').addEventListener('mouseup', () => {\r\n        setTimeout(() => {\r\n            const sel = window.getSelection();\r\n            if (sel && sel.toString().trim().length > 0) {\r\n                if (sel.anchorNode && sel.anchorNode.parentNode &&\r\n                    !sel.anchorNode.parentNode.classList.contains('placeholder')) {\r\n                    State.lastRange = sel.getRangeAt(0);\r\n                    const rect = State.lastRange.getBoundingClientRect();\r\n                    positionMenu(selectionMenu, rect);\r\n                }\r\n            } else {\r\n                hideMenu(selectionMenu);\r\n            }\r\n        }, 0);\r\n    });\r\n\r\n    document.addEventListener('click', (e) => {\r\n        if (!selectionMenu.contains(e.target) && !placeholderEditMenu.contains(e.target)) {\r\n            hideAllMenus();\r\n        }\r\n    });\r\n\r\n    document.getElementById('newPlaceholderBtn').addEventListener('click', () => {\r\n        hideMenu(selectionMenu);\r\n        $('#placeholderModal').modal('show');\r\n    });\r\n\r\n    document.getElementById('reusePlaceholderBtn').addEventListener('click', () => {\r\n        hideMenu(selectionMenu);\r\n        if (State.variables.length === 0) {\r\n            Swal.fire('No existing placeholders', 'There are no placeholders to reuse yet.', 'info');\r\n            return;\r\n        }\r\n        const sortedVariables = [...variables].sort((a, b) =>\r\n            (State.usageTracker[b.id] || 0) - (State.usageTracker[a.id] || 0) || a.order - b.order\r\n        );\r\n        let html = `<div id=\"reusePlaceholderContainer\" style=\"display: flex; flex-wrap: wrap;\">`;\r\n        sortedVariables.forEach(v => {\r\n            const displayText = v.displayOverride || v.officialDisplay;\r\n            html += `<button type=\"button\" \r\n                       class=\"btn btn-outline-secondary btn-sm m-1 reuse-placeholder-btn\" \r\n                       data-id=\"${v.id}\" \r\n                       title=\"${v.id}\">\r\n                 ${displayText}\r\n               </button>`;\r\n        });\r\n        html += `</div>`;\r\n        Swal.fire({\r\n            title: 'Select a placeholder to reuse',\r\n            html,\r\n            showCancelButton: true,\r\n            showConfirmButton: false,\r\n            didOpen: () => {\r\n                const container = Swal.getHtmlContainer();\r\n                const btns = container.querySelectorAll('.reuse-placeholder-btn');\r\n                btns.forEach(button => {\r\n                    button.addEventListener('click', () => {\r\n                        const id = button.getAttribute('data-id');\r\n                        const variable = State.variables.find(v => v.id === id);\r\n                        if (variable) duplicatePlaceholder(variable);\r\n                        Swal.close();\r\n                    });\r\n                });\r\n            }\r\n        });\r\n    });\r\n\r\n    // ====================================================\r\n    // 15. CRITICAL: UPDATE State.VARIABLES FROM EDITOR (MODIFIED)\r\n    // ====================================================\r\n    const updateVariablesFromEditor = () => {\r\n        State.variables = [];\r\n        State.variableCounts = {};\r\n        State.insertionCounter = 0;\r\n        const editor = document.getElementById('storyText');\r\n        const placeholderElements = editor.querySelectorAll('.placeholder');\r\n        placeholderElements.forEach(el => {\r\n            const id = el.getAttribute('data-id');\r\n            const base = id.replace(/\\d+$/, '');\r\n            const numMatch = id.match(/(\\d+)$/);\r\n            const num = numMatch ? parseInt(numMatch[1], 10) : 0;\r\n            if (!State.variableCounts[base] || num > State.variableCounts[base]) {\r\n                State.variableCounts[base] = num;\r\n            }\r\n            if (!State.variables.some(v => v.id === id)) {\r\n                let variableEntry;\r\n                const custom = State.customPlaceholders.find(p => p.type === base);\r\n                if (custom) {\r\n                    variableEntry = {\r\n                        id,\r\n                        internalType: custom.type,\r\n                        officialDisplay: TypeHelpers.naturalizeType(custom.type),\r\n                        display: TypeHelpers.naturalizeType(custom.type),\r\n                        isCustom: true,\r\n                        order: State.insertionCounter++,\r\n                        displayOverride: el.textContent\r\n                    };\r\n                } else {\r\n                    const guessed = TypeHelpers.guessTypeFromId(id);\r\n                    const originalDisplay = TypeHelpers.getOriginalDisplayForType(guessed) || guessed;\r\n                    variableEntry = {\r\n                        id,\r\n                        internalType: guessed,\r\n                        officialDisplay: originalDisplay,\r\n                        display: originalDisplay,\r\n                        order: State.insertionCounter++,\r\n                        displayOverride: el.textContent\r\n                    };\r\n                }\r\n                State.variables.push(variableEntry);\r\n            }\r\n        });\r\n\r\n        const currentSearch = $('#placeholderSearch').val() || '';\r\n        updatePlaceholderAccordion('#placeholderAccordion', '#noResults', currentSearch);\r\n\r\n        const currentModalSearch = $('#modalPlaceholderSearch').val() || '';\r\n        updatePlaceholderAccordion('#modalPlaceholderAccordion', '#modalNoResults', currentModalSearch);\r\n\r\n        updateVariablesList();\r\n\r\n    };\r\n\r\n\r\n    const generateLegacyText = () => {\r\n        const editor = document.getElementById(\"storyText\");\r\n        const traverse = (node) => {\r\n            let result = \"\";\r\n            node.childNodes.forEach(child => {\r\n                if (child.nodeType === Node.TEXT_NODE) {\r\n                    result += child.textContent;\r\n                } else if (child.nodeType === Node.ELEMENT_NODE) {\r\n                    if (child.tagName.toLowerCase() === \"br\") {\r\n                        result += \"\\n\";\r\n                    } else if (child.classList.contains(\"placeholder\")) {\r\n                        result += \"{\" + child.getAttribute(\"data-id\") + \"}\";\r\n                    } else {\r\n                        result += traverse(child);\r\n                        const tag = child.tagName.toLowerCase();\r\n                        if (tag === \"div\" || tag === \"p\") result += \"\\n\";\r\n                    }\r\n                }\r\n            });\r\n            return result;\r\n        };\r\n        return traverse(editor);\r\n    };\r\n\r\n})();\r\n"],"names":["state","variables","variableCounts","insertionCounter","storyText","customPlaceholders","fillValues","pronounGroups","pronounGroupCount","lastRange","usageTracker","placeholderInsertionInProgress","storyHasUnsavedChanges","fillOrder","currentStoryId","currentPlaceholderSearch","currentModalPlaceholderSearch","currentEditingVariable","currentPlaceholderElement","isEditingPlaceholder","pronounMapping","subject","object","possAdj","possPron","reflexive","resetState","Utils","debounce","func","delay","timeout","_len","arguments","length","args","Array","_key","context","clearTimeout","setTimeout","apply","toTitleCase","str","replace","txt","charAt","toUpperCase","substr","toLowerCase","capitalize","slice","pascalCase","split","map","word","join","naturalDisplay","sanitizeString","decodeHTMLEntities","text","textarea","document","createElement","innerHTML","value","_regeneratorRuntime","e","t","r","Object","prototype","n","hasOwnProperty","o","defineProperty","i","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","call","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","p","d","getPrototypeOf","v","values","g","defineIteratorMethods","forEach","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","Error","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","stop","rval","handle","complete","finish","_catch","delegateYield","asyncGeneratorStep","_asyncToGenerator","_next","_throw","_createForOfIteratorHelper","isArray","_unsupportedIterableToArray","_n","F","_arrayLikeToArray","toString","from","test","State","window","addEventListener","editor","getElementById","sel","getSelection","rangeCount","contains","anchorNode","getRangeAt","Storage","handleAjaxError","xhr","statusText","errorThrown","customErrorMessage","errorMessage","status","concat","Swal","fire","console","error","addCurrentStoryToSavedStories","story","storyTitle","$","val","storyAuthor","html","tags","trim","savedAt","Date","toISOString","password","data","ajax","url","contentType","JSON","stringify","success","toast","position","icon","title","showConfirmButton","timer","showCancelButton","confirmButtonText","cancelButtonText","result","isConfirmed","storyWithOverwrite","author","overwrite","xhrOverwrite","statusTextOverwrite","errorThrownOverwrite","addCompletedStoryToSavedStories","loadSavedStoriesList","tag","sort","encodeURIComponent","stories","savedStories","$listContainer","empty","append","index","dateObj","dateStr","toLocaleDateString","toLocaleTimeString","ratingDisplay","ratingCount","rating","toFixed","lockIndicator","locked","item","createSavedStoryListItem","loadSavedStory","mode","undefined","input","inputPlaceholder","inputAttributes","autocapitalize","autocorrect","storyId","_id","unlockedStory","populateEditorWithStory","show","hide","updateVariablesFromEditor","removeClass","addClass","buildFillForm","deleteSavedStory","TypeHelpers","naturalizeType","startsWith","sub","substring","tense","tenseNatural","verbTenseMap","remainder","category","rest","getTooltipForType","normalizedType","allPlaceholders","_iterator","_step","internalType","tooltip","err","verbTensePrefixes","_i","_verbTensePrefixes","prefix","baseType","_iterator2","_step2","getOriginalDisplayForType","_iterator3","_step3","display","guessTypeFromId","id","base","custom","find","pronounFixedRe","match","groupNum","abbrev","formMapReverse","SUB","OBJ","PSA","PSP","REF","pronounRe","m","getNounFinalType","baseInternal","number","baseTag","extra","indexOf","parts","finalTag","computeFinalVerbType","tenseTag","baseCategory","categoryOrder","isPrimary","insertNodeAtCaret","node","range","deleteContents","insertNode","newRange","createRange","setStartAfter","collapse","removeAllRanges","addRange","insertPlaceholderSpan","placeholderID","displayText","span","className","setAttribute","textContent","endsWith","parentNode","nextNode","nextSibling","nodeType","Node","TEXT_NODE","insertBefore","createTextNode","appendChild","duplicatePlaceholder","variable","newId","rangeToUse","commonAncestorContainer","ensureEditorFocus","displayOverride","officialDisplay","focus","selectNodeContents","insertPlaceholder","_ref","_callee","isCustom","sanitized","spans","max","newCount","selectedText","_yield$Swal$fire","temp","_callee$","_context","querySelectorAll","getAttribute","num","parseInt","collapsed","inputLabel","inputValue","some","order","updateVariablesList","applyPlaceholderToAllOccurrences","_x","_x2","_x3","insertPronounPlaceholderSimple","groupId","form","tempValue","formAbbrevMap","placeholderId","displayType","choosePronounTempValue","inputOptions","inputValidator","res","formatLabel","container","b","btn","updatePlaceholderAccordion","accordionSelector","noResultsSelector","searchVal","accordion","categoryName","placeholders","categoryCard","createPlaceholderCategoryCard","customCard","createCustomPlaceholderCategoryCard","anyShown","toggle","sanitizedCategoryName","card","createCardHeader","collapseDiv","primaryItems","filter","secondaryItems","appendPlaceholderItem","secondaryPlaceholderWrapper","createSecondaryPlaceholderWrapper","createShowMoreToggle","updateShowMoreToggleVisibility","showItem","includes","hiddenWrapper","toggleLink","anySecondaryVisible","listGroup","placeholder","isSecondary","on","stopPropagation","currentTarget","timerProgressBar","parentList","closest","hiddenItems","link","addNewCustomPlaceholderWithUsage","rawText","usage","internal","addNewCustomPlaceholder","insertPlaceholderFromCustom","raw","showNounNumberSelection","showVerbTenseSelection","modal","stopImmediatePropagation","preventDefault","hasClass","pickPronounFormAndGroup","showPersonTypeSelection","updateExistingPlaceholder","baseDisplay","allowOutsideClick","didOpen","getHtmlContainer","selectedType","updatedBaseInternal","updatedBaseDisplay","close","_callee2","selected","finalInternal","finalDisplay","_callee2$","_context2","VERB_TENSES","_callee3","selectedTense","tenseText","_callee3$","_context3","forms","chosenForm","pickPronounGroup","groupKeys","grp","newGroup","appendPronounGroupsToForm","appendNonPronounVariablesToForm","groupSet","getPronounGroups","sortedGroups","localeCompare","block","createPronounGroupBlock","handlePronounChoiceChange","Set","_iterator4","_step4","add","groupName","radios","attr","nonPronounVars","Math","random","groupRow","createInputRow","ready","autocomplete","source","request","response","dataType","filteredTags","ui","term","minLength","select","event","click","finalText","content","navigator","clipboard","writeText","fallbackCopyTextToClipboard","style","top","body","successful","execCommand","removeChild","target","file","files","reader","FileReader","onload","titleMatch","authorMatch","storyStartIndex","storyContent","readAsText","generateLegacyText","inputs","valid","each","pid","label","pronounComplete","_iterator5","_step5","remove","choice","splitted","predefined","HeHim","SheHer","TheyThem","_objectSpread","final","_iterator6","_step6","phRegex","RegExp","groupObj","userVal","showDenyButton","denyButtonText","createNewStory","isDenied","loadPreexistingTags","current","tagsArr","Boolean","preConfirm","blob","Blob","URL","createObjectURL","href","fileName","download","revokeObjectURL","key","classList","anchorOffset","nodeValue","setStartBefore","positionMenu","menu","rect","menuWidth","offsetWidth","menuHeight","offsetHeight","offset","desiredTop","bottom","innerHeight","scrollY","desiredLeft","scrollX","left","width","min","innerWidth","hideMenu","hideAllMenus","selectionMenu","placeholderEditMenu","assign","zIndex","background","border","padding","borderRadius","boxShadow","getBoundingClientRect","_callee4","_yield$Swal$fire2","newOverride","_callee4$","_context4","sortedVariables","_toConsumableArray","btns","button","placeholderElements","el","numMatch","variableEntry","guessed","originalDisplay","currentSearch","currentModalSearch","traverse","childNodes","child","ELEMENT_NODE","tagName"],"sourceRoot":""}